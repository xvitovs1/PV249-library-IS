  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE "authors" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE "books" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author_id" integer, "description" text, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mselect sqlite_version(*)[0m
  [1m[35m (9.9ms)[0m  [1m[35mCREATE  INDEX "index_books_on_author_id" ON "books" ("author_id")[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "borrows" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "borrow_date" date, "expected_return_date" date, "return_date" date, "reader_id" integer, "publication_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_publication_id" ON "borrows" ("publication_id")[0m
  [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_reader_id" ON "borrows" ("reader_id")[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "publications" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "ISBN" varchar, "year" integer, "publisher_id" integer, "img_url" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "book_id" integer, "borrowed" boolean DEFAULT 'f')[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_publications_on_ISBN" ON "publications" ("ISBN")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (10.9ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_book_id" ON "publications" ("book_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_book_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_book_id' AND type='index'
[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (7.6ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_publisher_id" ON "publications" ("publisher_id")[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE TABLE "publishers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "readers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "card_code" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (8.5ms)[0m  [1m[35mCREATE TABLE "users" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT version FROM "schema_migrations"[0m
  [1m[35m (6.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES ('20170123131531')[0m
  [1m[35m (7.5ms)[0m  [1m[32mINSERT INTO schema_migrations (version) VALUES
('20170123131023'),
('20161223112524'),
('20170107164735'),
('20170107165431'),
('20170123082356'),
('20161223112601'),
('20170107165622'),
('20170107170244'),
('20170107164915');

[0m
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", 2017-01-23 13:22:54 UTC], ["updated_at", 2017-01-23 13:22:54 UTC]]
  [1m[35m (5.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.348027', '2017-01-23 13:22:54.348027', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.348027', '2017-01-23 13:22:54.348027', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.356670', '2017-01-23 13:22:54.356670', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.356670', '2017-01-23 13:22:54.356670', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.360213', '2017-01-23 13:22:54.360213', 980190962, 980190962)[0m
  [1m[36mFixture Insert (1.0ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.360213', '2017-01-23 13:22:54.360213', 298486374, 298486374)[0m
  [1m[35m (4.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.9ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.905294', '2017-01-23 13:22:54.905294', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.905294', '2017-01-23 13:22:54.905294', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.908998', '2017-01-23 13:22:54.908998', 980190962)[0m
  [1m[36mFixture Insert (0.0ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.908998', '2017-01-23 13:22:54.908998', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.910360', '2017-01-23 13:22:54.910360', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.7ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.910360', '2017-01-23 13:22:54.910360', 298486374, 298486374)[0m
  [1m[35m (5.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.927128', '2017-01-23 13:22:54.927128', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.927128', '2017-01-23 13:22:54.927128', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.931409', '2017-01-23 13:22:54.931409', 980190962)[0m
  [1m[36mFixture Insert (1.0ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.931409', '2017-01-23 13:22:54.931409', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.934284', '2017-01-23 13:22:54.934284', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.934284', '2017-01-23 13:22:54.934284', 298486374, 298486374)[0m
  [1m[35m (6.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (5.6ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.953870', '2017-01-23 13:22:54.953870', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.953870', '2017-01-23 13:22:54.953870', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.961766', '2017-01-23 13:22:54.961766', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.961766', '2017-01-23 13:22:54.961766', 298486374)[0m
  [1m[36mFixture Delete (1.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.963985', '2017-01-23 13:22:54.963985', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.963985', '2017-01-23 13:22:54.963985', 298486374, 298486374)[0m
  [1m[35m (5.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.983936', '2017-01-23 13:22:54.983936', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.983936', '2017-01-23 13:22:54.983936', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.989429', '2017-01-23 13:22:54.989429', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:54.989429', '2017-01-23 13:22:54.989429', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.991559', '2017-01-23 13:22:54.991559', 980190962, 980190962)[0m
  [1m[36mFixture Insert (1.0ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:54.991559', '2017-01-23 13:22:54.991559', 298486374, 298486374)[0m
  [1m[35m (5.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.9ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.019655', '2017-01-23 13:22:55.019655', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.019655', '2017-01-23 13:22:55.019655', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.028761', '2017-01-23 13:22:55.028761', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.028761', '2017-01-23 13:22:55.028761', 298486374)[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.032250', '2017-01-23 13:22:55.032250', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.032250', '2017-01-23 13:22:55.032250', 298486374, 298486374)[0m
  [1m[35m (6.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.053858', '2017-01-23 13:22:55.053858', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.053858', '2017-01-23 13:22:55.053858', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.059378', '2017-01-23 13:22:55.059378', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.059378', '2017-01-23 13:22:55.059378', 298486374)[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.061622', '2017-01-23 13:22:55.061622', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.061622', '2017-01-23 13:22:55.061622', 298486374, 298486374)[0m
  [1m[35m (8.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.7ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.082386', '2017-01-23 13:22:55.082386', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.082386', '2017-01-23 13:22:55.082386', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.088122', '2017-01-23 13:22:55.088122', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.088122', '2017-01-23 13:22:55.088122', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.090516', '2017-01-23 13:22:55.090516', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.9ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.090516', '2017-01-23 13:22:55.090516', 298486374, 298486374)[0m
  [1m[35m (7.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (4.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.113968', '2017-01-23 13:22:55.113968', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.113968', '2017-01-23 13:22:55.113968', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.0ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.120611', '2017-01-23 13:22:55.120611', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.120611', '2017-01-23 13:22:55.120611', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.126155', '2017-01-23 13:22:55.126155', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.8ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.126155', '2017-01-23 13:22:55.126155', 298486374, 298486374)[0m
  [1m[35m (9.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.153554', '2017-01-23 13:22:55.153554', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.153554', '2017-01-23 13:22:55.153554', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.161140', '2017-01-23 13:22:55.161140', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.161140', '2017-01-23 13:22:55.161140', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.166713', '2017-01-23 13:22:55.166713', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.166713', '2017-01-23 13:22:55.166713', 298486374, 298486374)[0m
  [1m[35m (5.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (4.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.184091', '2017-01-23 13:22:55.184091', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.184091', '2017-01-23 13:22:55.184091', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.191761', '2017-01-23 13:22:55.191761', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:22:55.191761', '2017-01-23 13:22:55.191761', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.193527', '2017-01-23 13:22:55.193527', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:22:55.193527', '2017-01-23 13:22:55.193527', 298486374, 298486374)[0m
  [1m[35m (4.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.633697', '2017-01-23 13:24:14.633697', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.633697', '2017-01-23 13:24:14.633697', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.646823', '2017-01-23 13:24:14.646823', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.646823', '2017-01-23 13:24:14.646823', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:24:14.650668', '2017-01-23 13:24:14.650668', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:24:14.650668', '2017-01-23 13:24:14.650668', 298486374, 298486374)[0m
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.665450', '2017-01-23 13:24:14.665450', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.665450', '2017-01-23 13:24:14.665450', 298486374)[0m
  [1m[36mFixture Delete (1.8ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.668503', '2017-01-23 13:24:14.668503', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:24:14.668503', '2017-01-23 13:24:14.668503', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:24:14.672567', '2017-01-23 13:24:14.672567', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:24:14.672567', '2017-01-23 13:24:14.672567', 298486374, 298486374)[0m
  [1m[35m (4.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.760903', '2017-01-23 13:25:55.760903', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.760903', '2017-01-23 13:25:55.760903', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.770892', '2017-01-23 13:25:55.770892', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.770892', '2017-01-23 13:25:55.770892', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.774346', '2017-01-23 13:25:55.774346', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.774346', '2017-01-23 13:25:55.774346', 298486374, 298486374)[0m
  [1m[35m (4.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.801916', '2017-01-23 13:25:55.801916', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.801916', '2017-01-23 13:25:55.801916', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.807604', '2017-01-23 13:25:55.807604', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.807604', '2017-01-23 13:25:55.807604', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.809775', '2017-01-23 13:25:55.809775', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.809775', '2017-01-23 13:25:55.809775', 298486374, 298486374)[0m
  [1m[35m (4.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.826438', '2017-01-23 13:25:55.826438', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.826438', '2017-01-23 13:25:55.826438', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.831718', '2017-01-23 13:25:55.831718', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:25:55.831718', '2017-01-23 13:25:55.831718', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.833750', '2017-01-23 13:25:55.833750', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:25:55.833750', '2017-01-23 13:25:55.833750', 298486374, 298486374)[0m
  [1m[35m (7.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (1.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.800506', '2017-01-23 13:32:30.800506', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.800506', '2017-01-23 13:32:30.800506', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.812069', '2017-01-23 13:32:30.812069', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.812069', '2017-01-23 13:32:30.812069', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:32:30.816328', '2017-01-23 13:32:30.816328', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 13:32:30.816328', '2017-01-23 13:32:30.816328', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.823102', '2017-01-23 13:32:30.823102', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.823102', '2017-01-23 13:32:30.823102', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[35m (3.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.839506', '2017-01-23 13:32:30.839506', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.839506', '2017-01-23 13:32:30.839506', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.0ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.843095', '2017-01-23 13:32:30.843095', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.843095', '2017-01-23 13:32:30.843095', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:32:30.844555', '2017-01-23 13:32:30.844555', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 13:32:30.844555', '2017-01-23 13:32:30.844555', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.846313', '2017-01-23 13:32:30.846313', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.846313', '2017-01-23 13:32:30.846313', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[35m (4.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.861385', '2017-01-23 13:32:30.861385', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.861385', '2017-01-23 13:32:30.861385', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.866816', '2017-01-23 13:32:30.866816', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:32:30.866816', '2017-01-23 13:32:30.866816', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:32:30.869083', '2017-01-23 13:32:30.869083', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 13:32:30.869083', '2017-01-23 13:32:30.869083', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.872420', '2017-01-23 13:32:30.872420', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:32:30.872420', '2017-01-23 13:32:30.872420', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[35m (4.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.9ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.237344', '2017-01-23 13:33:30.237344', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.237344', '2017-01-23 13:33:30.237344', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.250350', '2017-01-23 13:33:30.250350', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.250350', '2017-01-23 13:33:30.250350', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:33:30.252926', '2017-01-23 13:33:30.252926', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 13:33:30.252926', '2017-01-23 13:33:30.252926', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:33:30.256295', '2017-01-23 13:33:30.256295', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:33:30.256295', '2017-01-23 13:33:30.256295', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 13:33:30.259069', '2017-01-23 13:33:30.259069', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 13:33:30.259069', '2017-01-23 13:33:30.259069', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 13:33:30.261589', '2017-01-23 13:33:30.261589', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 13:33:30.261589', '2017-01-23 13:33:30.261589', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.265336', '2017-01-23 13:33:30.265336', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:33:30.265336', '2017-01-23 13:33:30.265336', 298486374)[0m
  [1m[35m (6.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (8.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.252557', '2017-01-23 13:59:49.252557', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.252557', '2017-01-23 13:59:49.252557', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.274124', '2017-01-23 13:59:49.274124', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.274124', '2017-01-23 13:59:49.274124', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 13:59:49.276956', '2017-01-23 13:59:49.276956', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 13:59:49.276956', '2017-01-23 13:59:49.276956', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:59:49.282055', '2017-01-23 13:59:49.282055', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 13:59:49.282055', '2017-01-23 13:59:49.282055', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 13:59:49.286774', '2017-01-23 13:59:49.286774', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 13:59:49.286774', '2017-01-23 13:59:49.286774', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 13:59:49.290270', '2017-01-23 13:59:49.290270', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 13:59:49.290270', '2017-01-23 13:59:49.290270', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.293835', '2017-01-23 13:59:49.293835', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 13:59:49.293835', '2017-01-23 13:59:49.293835', 298486374)[0m
  [1m[35m (70.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$0.gc0Va2Hw.uCtEQ.cKIZu4DBAw9ULfbuuHmP1e/nQRTWhDj.YDSS"], ["created_at", 2017-01-23 13:59:49 UTC], ["updated_at", 2017-01-23 13:59:49 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_as_lower-case
------------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "Foo@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "foo@example.com"], ["password_digest", "$2a$04$2X6xUUes0LAulcZ8VKoJNOjxXNKUfz.WTPpf0k.yfYP7MSjskqplW"], ["created_at", 2017-01-23 13:59:49 UTC], ["updated_at", 2017-01-23 13:59:49 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
UserTest: test_email_validation_should_reject_invalid_addresses
---------------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user_at_foo.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.name@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "foo@bar_baz.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "foo@bar+baz.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------
UserTest: test_email_validation_should_accept_valid_addresses
-------------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@foo.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "A_US-ER@foo.bar.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "first.last@foo.jp"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "alice+bob@baz.cn"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (4.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.156538', '2017-01-23 14:05:35.156538', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.156538', '2017-01-23 14:05:35.156538', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.169279', '2017-01-23 14:05:35.169279', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.169279', '2017-01-23 14:05:35.169279', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:05:35.172939', '2017-01-23 14:05:35.172939', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:05:35.172939', '2017-01-23 14:05:35.172939', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:05:35.176913', '2017-01-23 14:05:35.176913', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:05:35.176913', '2017-01-23 14:05:35.176913', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:05:35.183760', '2017-01-23 14:05:35.183760', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:05:35.183760', '2017-01-23 14:05:35.183760', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:05:35.186672', '2017-01-23 14:05:35.186672', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:05:35.186672', '2017-01-23 14:05:35.186672', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.189577', '2017-01-23 14:05:35.189577', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:05:35.189577', '2017-01-23 14:05:35.189577', 298486374)[0m
  [1m[35m (71.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (3.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (2.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$q5gdilKCZNQVS.o.dzqPdOJIVMU26niJt6RFyCNaQjX7QYcbDUT1K"], ["created_at", 2017-01-23 14:05:35 UTC], ["updated_at", 2017-01-23 14:05:35 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$lSC1Pk9X.9Ya4P4e38LsZuqdxbQI/OT/DoOEJjiIbZv.p.IrDbS8i"], ["created_at", 2017-01-23 14:05:35 UTC], ["updated_at", 2017-01-23 14:05:35 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.285885', '2017-01-23 14:06:03.285885', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.285885', '2017-01-23 14:06:03.285885', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.299215', '2017-01-23 14:06:03.299215', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.299215', '2017-01-23 14:06:03.299215', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:06:03.302072', '2017-01-23 14:06:03.302072', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:06:03.302072', '2017-01-23 14:06:03.302072', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:06:03.305566', '2017-01-23 14:06:03.305566', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:06:03.305566', '2017-01-23 14:06:03.305566', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:06:03.311531', '2017-01-23 14:06:03.311531', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:06:03.311531', '2017-01-23 14:06:03.311531', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:06:03.314435', '2017-01-23 14:06:03.314435', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:06:03.314435', '2017-01-23 14:06:03.314435', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.318634', '2017-01-23 14:06:03.318634', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:03.318634', '2017-01-23 14:06:03.318634', 298486374)[0m
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$nVViXbSRP156RCIvVRSB5uUn0fJS0Vu8hjLcNqnHcYPJBQY9Z8b3a"], ["created_at", 2017-01-23 14:06:03 UTC], ["updated_at", 2017-01-23 14:06:03 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (2.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$BpzZMaCaHtHt7bHHNqSktuQTBtiiYFxf7mLGMX4soD5QmX/XIqoQG"], ["created_at", 2017-01-23 14:06:03 UTC], ["updated_at", 2017-01-23 14:06:03 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (2.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.9ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.471752', '2017-01-23 14:06:31.471752', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.471752', '2017-01-23 14:06:31.471752', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.483220', '2017-01-23 14:06:31.483220', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.483220', '2017-01-23 14:06:31.483220', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:06:31.487648', '2017-01-23 14:06:31.487648', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:06:31.487648', '2017-01-23 14:06:31.487648', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:06:31.492874', '2017-01-23 14:06:31.492874', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:06:31.492874', '2017-01-23 14:06:31.492874', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:06:31.495730', '2017-01-23 14:06:31.495730', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:06:31.495730', '2017-01-23 14:06:31.495730', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:06:31.498271', '2017-01-23 14:06:31.498271', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:06:31.498271', '2017-01-23 14:06:31.498271', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.7ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.501834', '2017-01-23 14:06:31.501834', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:06:31.501834', '2017-01-23 14:06:31.501834', 298486374)[0m
  [1m[35m (8.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$lURH4qek8cBD8FpxaSE7W.AvBm/ZH9lP9qcqob7OnYUw0RiCbUOwK"], ["created_at", 2017-01-23 14:06:31 UTC], ["updated_at", 2017-01-23 14:06:31 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (3.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (4.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$.eHkW1wCv5RFaDtLrAhKDuryZkvysup.pLGW9kgrHEFl6TWE/cLL6"], ["created_at", 2017-01-23 14:06:31 UTC], ["updated_at", 2017-01-23 14:06:31 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (13.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.682601', '2017-01-23 14:14:07.682601', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.682601', '2017-01-23 14:14:07.682601', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.692956', '2017-01-23 14:14:07.692956', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.692956', '2017-01-23 14:14:07.692956', 298486374)[0m
  [1m[36mFixture Delete (1.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:14:07.696156', '2017-01-23 14:14:07.696156', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:14:07.696156', '2017-01-23 14:14:07.696156', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:14:07.703307', '2017-01-23 14:14:07.703307', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:14:07.703307', '2017-01-23 14:14:07.703307', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:14:07.712451', '2017-01-23 14:14:07.712451', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:14:07.712451', '2017-01-23 14:14:07.712451', 298486374)[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:14:07.715393', '2017-01-23 14:14:07.715393', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:14:07.715393', '2017-01-23 14:14:07.715393', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.720238', '2017-01-23 14:14:07.720238', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:14:07.720238', '2017-01-23 14:14:07.720238', 298486374)[0m
  [1m[35m (74.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (4.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$dGHz/R0QiREp/ACTrKdnaeRNfcSzFie9jlN9FSjxuK7T.McuuXRcG"], ["created_at", 2017-01-23 14:14:07 UTC], ["updated_at", 2017-01-23 14:14:07 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$5/UhRmR3yKSAO32nq.UIIe8GyggqG10yq715XD/9WJ6Vz.78X0wja"], ["created_at", 2017-01-23 14:14:07 UTC], ["updated_at", 2017-01-23 14:14:07 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.396078', '2017-01-23 14:17:55.396078', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.396078', '2017-01-23 14:17:55.396078', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.405594', '2017-01-23 14:17:55.405594', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.405594', '2017-01-23 14:17:55.405594', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:17:55.410119', '2017-01-23 14:17:55.410119', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:17:55.410119', '2017-01-23 14:17:55.410119', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:17:55.414642', '2017-01-23 14:17:55.414642', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:17:55.414642', '2017-01-23 14:17:55.414642', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:17:55.418683', '2017-01-23 14:17:55.418683', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:17:55.418683', '2017-01-23 14:17:55.418683', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:17:55.421318', '2017-01-23 14:17:55.421318', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:17:55.421318', '2017-01-23 14:17:55.421318', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.424369', '2017-01-23 14:17:55.424369', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:17:55.424369', '2017-01-23 14:17:55.424369', 298486374)[0m
  [1m[35m (74.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$caj4os9HcV4S2/xX1cWyKO01V7eciCmOAolr9E/gV/jxVZneeRhaG"], ["created_at", 2017-01-23 14:17:55 UTC], ["updated_at", 2017-01-23 14:17:55 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (2.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (3.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (2.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$YKrR30bWgOINJWnYx6fID.AzmGj.uTqj0twjw/huUKNHX8LwmRjPm"], ["created_at", 2017-01-23 14:17:55 UTC], ["updated_at", 2017-01-23 14:17:55 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (3.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.019210', '2017-01-23 14:28:44.019210', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.019210', '2017-01-23 14:28:44.019210', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.028645', '2017-01-23 14:28:44.028645', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.028645', '2017-01-23 14:28:44.028645', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:28:44.032286', '2017-01-23 14:28:44.032286', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:28:44.032286', '2017-01-23 14:28:44.032286', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:28:44.037730', '2017-01-23 14:28:44.037730', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:28:44.037730', '2017-01-23 14:28:44.037730', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:28:44.044875', '2017-01-23 14:28:44.044875', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:28:44.044875', '2017-01-23 14:28:44.044875', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:28:44.047759', '2017-01-23 14:28:44.047759', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:28:44.047759', '2017-01-23 14:28:44.047759', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.052038', '2017-01-23 14:28:44.052038', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:28:44.052038', '2017-01-23 14:28:44.052038', 298486374)[0m
  [1m[35m (6.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$6QCo1j6wMyXAcapHy5jvGe3PKSqLHWzIA1uzhbjGGYHzKxK.SN5Ky"], ["created_at", 2017-01-23 14:28:44 UTC], ["updated_at", 2017-01-23 14:28:44 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$K/8Deqvc38ZEXtdTIm1GGOAEzr/IlPVRvwLpCFqifDwoNT.nFDB9e"], ["created_at", 2017-01-23 14:28:44 UTC], ["updated_at", 2017-01-23 14:28:44 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (3.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.580838', '2017-01-23 14:32:32.580838', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.580838', '2017-01-23 14:32:32.580838', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.590505', '2017-01-23 14:32:32.590505', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.590505', '2017-01-23 14:32:32.590505', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:32:32.593483', '2017-01-23 14:32:32.593483', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:32:32.593483', '2017-01-23 14:32:32.593483', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:32:32.599263', '2017-01-23 14:32:32.599263', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:32:32.599263', '2017-01-23 14:32:32.599263', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:32:32.603104', '2017-01-23 14:32:32.603104', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:32:32.603104', '2017-01-23 14:32:32.603104', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:32:32.606265', '2017-01-23 14:32:32.606265', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:32:32.606265', '2017-01-23 14:32:32.606265', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.610120', '2017-01-23 14:32:32.610120', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:32:32.610120', '2017-01-23 14:32:32.610120', 298486374)[0m
  [1m[35m (8.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.7ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$NGj0FnEQYsLr1TNXHMgtX.S21ZTi8Zzadf4csqp7mmm30gQoC0SMC"], ["created_at", 2017-01-23 14:32:32 UTC], ["updated_at", 2017-01-23 14:32:32 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$22.YNxsf0gyMQlbTQYh0ned.ZnCDuBJ6Pb4BXvkn03Qf2NlIH34nK"], ["created_at", 2017-01-23 14:32:32 UTC], ["updated_at", 2017-01-23 14:32:32 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_book_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.404751', '2017-01-23 14:34:21.404751', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.404751', '2017-01-23 14:34:21.404751', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.412359', '2017-01-23 14:34:21.412359', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.412359', '2017-01-23 14:34:21.412359', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:34:21.418311', '2017-01-23 14:34:21.418311', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:34:21.418311', '2017-01-23 14:34:21.418311', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:34:21.422756', '2017-01-23 14:34:21.422756', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:34:21.422756', '2017-01-23 14:34:21.422756', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:34:21.425648', '2017-01-23 14:34:21.425648', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:34:21.425648', '2017-01-23 14:34:21.425648', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:34:21.427976', '2017-01-23 14:34:21.427976', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:34:21.427976', '2017-01-23 14:34:21.427976', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.430989', '2017-01-23 14:34:21.430989', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:34:21.430989', '2017-01-23 14:34:21.430989', 298486374)[0m
  [1m[35m (4.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$Gf1Ql.e0ydMggW.k7mPhvupmXUqW27KfF.nVrPjNr9LajAXGs.xvK"], ["created_at", 2017-01-23 14:34:21 UTC], ["updated_at", 2017-01-23 14:34:21 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (2.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$FldmFRKGeY0u1hpFZ0bHdeYLNDTNaFDw67Nu5IO8loqUdgjtjvyZK"], ["created_at", 2017-01-23 14:34:21 UTC], ["updated_at", 2017-01-23 14:34:21 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (4.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.371724', '2017-01-23 14:37:24.371724', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.371724', '2017-01-23 14:37:24.371724', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.385359', '2017-01-23 14:37:24.385359', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.385359', '2017-01-23 14:37:24.385359', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:37:24.390292', '2017-01-23 14:37:24.390292', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:37:24.390292', '2017-01-23 14:37:24.390292', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:37:24.393760', '2017-01-23 14:37:24.393760', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:37:24.393760', '2017-01-23 14:37:24.393760', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.0ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:37:24.401139', '2017-01-23 14:37:24.401139', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:37:24.401139', '2017-01-23 14:37:24.401139', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:37:24.403909', '2017-01-23 14:37:24.403909', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:37:24.403909', '2017-01-23 14:37:24.403909', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.406897', '2017-01-23 14:37:24.406897', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:37:24.406897', '2017-01-23 14:37:24.406897', 298486374)[0m
  [1m[35m (74.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$FboFVlNIyMjQZcsNWz9CLOWpYhJHvju8NVW05uuQkH/HS.avaBkiC"], ["created_at", 2017-01-23 14:37:24 UTC], ["updated_at", 2017-01-23 14:37:24 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$1TxHi1GYtbb084vm2jsDMOELvgf5yLJkptpFy1Ne.cU5rm/J35y8m"], ["created_at", 2017-01-23 14:37:24 UTC], ["updated_at", 2017-01-23 14:37:24 UTC]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (6.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (1.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.248678', '2017-01-23 14:39:02.248678', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.248678', '2017-01-23 14:39:02.248678', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.257738', '2017-01-23 14:39:02.257738', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.257738', '2017-01-23 14:39:02.257738', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:39:02.261250', '2017-01-23 14:39:02.261250', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:39:02.261250', '2017-01-23 14:39:02.261250', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:02.265520', '2017-01-23 14:39:02.265520', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:02.265520', '2017-01-23 14:39:02.265520', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:02.270445', '2017-01-23 14:39:02.270445', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:02.270445', '2017-01-23 14:39:02.270445', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:02.273482', '2017-01-23 14:39:02.273482', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:02.273482', '2017-01-23 14:39:02.273482', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.277873', '2017-01-23 14:39:02.277873', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:02.277873', '2017-01-23 14:39:02.277873', 298486374)[0m
  [1m[35m (75.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (4.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$MxsXzaQmSdHxqO2vDlFeFu.jw2P4/gAySddOa939WrH8qD/5Fgw86"], ["created_at", 2017-01-23 14:39:02 UTC], ["updated_at", 2017-01-23 14:39:02 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (2.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$658ln89XLuq0/lBqpqD/WuUL8Q7/ZAfaJ6sV4/pKEIsjoBEJTREQS"], ["created_at", 2017-01-23 14:39:02 UTC], ["updated_at", 2017-01-23 14:39:02 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (4.6ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.939627', '2017-01-23 14:39:16.939627', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.939627', '2017-01-23 14:39:16.939627', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.953175', '2017-01-23 14:39:16.953175', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.953175', '2017-01-23 14:39:16.953175', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:39:16.955814', '2017-01-23 14:39:16.955814', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:39:16.955814', '2017-01-23 14:39:16.955814', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:16.959159', '2017-01-23 14:39:16.959159', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:16.959159', '2017-01-23 14:39:16.959159', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:16.961904', '2017-01-23 14:39:16.961904', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:16.961904', '2017-01-23 14:39:16.961904', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:16.965034', '2017-01-23 14:39:16.965034', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:16.965034', '2017-01-23 14:39:16.965034', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.968084', '2017-01-23 14:39:16.968084', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:16.968084', '2017-01-23 14:39:16.968084', 298486374)[0m
  [1m[35m (79.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (2.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$93jgRHx.JV93Si/orwqW/Oy5CfKZMrCTCIMvgDM/RmQZ/S.du.RNK"], ["created_at", 2017-01-23 14:39:17 UTC], ["updated_at", 2017-01-23 14:39:17 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (5.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (3.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$cGcqPhR0AP3FrORYMVD43uSTYGxPqlnDrK//VycjlfiwUB41er38a"], ["created_at", 2017-01-23 14:39:17 UTC], ["updated_at", 2017-01-23 14:39:17 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.7ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.769627', '2017-01-23 14:39:37.769627', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.769627', '2017-01-23 14:39:37.769627', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.779098', '2017-01-23 14:39:37.779098', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.779098', '2017-01-23 14:39:37.779098', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:39:37.782718', '2017-01-23 14:39:37.782718', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:39:37.782718', '2017-01-23 14:39:37.782718', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:37.786640', '2017-01-23 14:39:37.786640', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:39:37.786640', '2017-01-23 14:39:37.786640', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:37.790272', '2017-01-23 14:39:37.790272', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:39:37.790272', '2017-01-23 14:39:37.790272', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:37.793621', '2017-01-23 14:39:37.793621', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:39:37.793621', '2017-01-23 14:39:37.793621', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.799299', '2017-01-23 14:39:37.799299', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:39:37.799299', '2017-01-23 14:39:37.799299', 298486374)[0m
  [1m[35m (68.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$uFdQn6zel6ktzc9IkHHnaeYRrj5PYPpqtdChXBo99ofVW6AsleBpm"], ["created_at", 2017-01-23 14:39:37 UTC], ["updated_at", 2017-01-23 14:39:37 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$oe7SAMF8oIxM9GU26.NYbOjIfqnGeaomAlH0pUdMd5PnkTmYbMVoe"], ["created_at", 2017-01-23 14:39:37 UTC], ["updated_at", 2017-01-23 14:39:37 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (1.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (4.7ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.213562', '2017-01-23 14:40:54.213562', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.213562', '2017-01-23 14:40:54.213562', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.223884', '2017-01-23 14:40:54.223884', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.223884', '2017-01-23 14:40:54.223884', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:40:54.227592', '2017-01-23 14:40:54.227592', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:40:54.227592', '2017-01-23 14:40:54.227592', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:40:54.232069', '2017-01-23 14:40:54.232069', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:40:54.232069', '2017-01-23 14:40:54.232069', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:40:54.234998', '2017-01-23 14:40:54.234998', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:40:54.234998', '2017-01-23 14:40:54.234998', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:40:54.239015', '2017-01-23 14:40:54.239015', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:40:54.239015', '2017-01-23 14:40:54.239015', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.242974', '2017-01-23 14:40:54.242974', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:40:54.242974', '2017-01-23 14:40:54.242974', 298486374)[0m
  [1m[35m (69.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------
PublicationTest: test_should_belong_to_a_publisher
--------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (3.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$AS0lonv3nuuKVnPL9QPbCuaddWaOJfD.XlbdOVafsNpK20g2gAuWm"], ["created_at", 2017-01-23 14:40:54 UTC], ["updated_at", 2017-01-23 14:40:54 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (5.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (3.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$wmWmff0/swwKA567fFg4L.vKdKKEVMYrZ36FHzDT91V7QOm.kLSjy"], ["created_at", 2017-01-23 14:40:54 UTC], ["updated_at", 2017-01-23 14:40:54 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (2.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (3.1ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.005632', '2017-01-23 14:41:24.005632', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.005632', '2017-01-23 14:41:24.005632', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.021150', '2017-01-23 14:41:24.021150', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.021150', '2017-01-23 14:41:24.021150', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:41:24.027035', '2017-01-23 14:41:24.027035', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:41:24.027035', '2017-01-23 14:41:24.027035', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:41:24.031774', '2017-01-23 14:41:24.031774', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:41:24.031774', '2017-01-23 14:41:24.031774', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:41:24.034513', '2017-01-23 14:41:24.034513', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:41:24.034513', '2017-01-23 14:41:24.034513', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:41:24.037410', '2017-01-23 14:41:24.037410', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:41:24.037410', '2017-01-23 14:41:24.037410', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.040406', '2017-01-23 14:41:24.040406', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:41:24.040406', '2017-01-23 14:41:24.040406', 298486374)[0m
  [1m[35m (70.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (2.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$GXPbV/5okbbL0ExFQWUlveJ4oMfXssriZwzSdNSEp6Op42Vcru.se"], ["created_at", 2017-01-23 14:41:24 UTC], ["updated_at", 2017-01-23 14:41:24 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (6.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.7ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (2.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$SlFxd5R6OvpHo1jFUS.ExeJPXTZy3XswJfCx.AhDXgBqX736da49C"], ["created_at", 2017-01-23 14:41:24 UTC], ["updated_at", 2017-01-23 14:41:24 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (9.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------
PublicationTest: test_should_belong_to_a_publisher
--------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.406799', '2017-01-23 14:42:22.406799', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.406799', '2017-01-23 14:42:22.406799', 298486374)[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.416662', '2017-01-23 14:42:22.416662', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.416662', '2017-01-23 14:42:22.416662', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:42:22.422095', '2017-01-23 14:42:22.422095', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:42:22.422095', '2017-01-23 14:42:22.422095', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:42:22.426384', '2017-01-23 14:42:22.426384', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:42:22.426384', '2017-01-23 14:42:22.426384', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:42:22.430581', '2017-01-23 14:42:22.430581', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:42:22.430581', '2017-01-23 14:42:22.430581', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:42:22.433046', '2017-01-23 14:42:22.433046', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:42:22.433046', '2017-01-23 14:42:22.433046', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.436006', '2017-01-23 14:42:22.436006', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:22.436006', '2017-01-23 14:42:22.436006', 298486374)[0m
  [1m[35m (72.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (2.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$bwN7CnbydDBuRJaX9A4NqOAhT7mQqJ80sP8MxBBmbZp2wt7kXwH7e"], ["created_at", 2017-01-23 14:42:22 UTC], ["updated_at", 2017-01-23 14:42:22 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (7.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$n8CzWQxtGD2cJ1PF799mSuijTYthg2ZB4REPzTYaYBG4EwGHPRkXm"], ["created_at", 2017-01-23 14:42:22 UTC], ["updated_at", 2017-01-23 14:42:22 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (6.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------------
PublicationTest: test_should_belong_to_a_publisher
--------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
PublicationTest: test_should_belong_to_a_book
---------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.739497', '2017-01-23 14:42:46.739497', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.739497', '2017-01-23 14:42:46.739497', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.748766', '2017-01-23 14:42:46.748766', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.748766', '2017-01-23 14:42:46.748766', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-23 14:42:46.753422', '2017-01-23 14:42:46.753422', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-23 14:42:46.753422', '2017-01-23 14:42:46.753422', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:42:46.760600', '2017-01-23 14:42:46.760600', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-23 14:42:46.760600', '2017-01-23 14:42:46.760600', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:42:46.767442', '2017-01-23 14:42:46.767442', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-23 14:42:46.767442', '2017-01-23 14:42:46.767442', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:42:46.770433', '2017-01-23 14:42:46.770433', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-23 14:42:46.770433', '2017-01-23 14:42:46.770433', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.774426', '2017-01-23 14:42:46.774426', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-23 14:42:46.774426', '2017-01-23 14:42:46.774426', 298486374)[0m
  [1m[35m (8.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$1FNgHrwf8rQXLuYGMajK.ebtcoWey6/GCJxU7ShnMrWQqrxuMt5fO"], ["created_at", 2017-01-23 14:42:46 UTC], ["updated_at", 2017-01-23 14:42:46 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (2.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$LUMDSQKKjrggqUIdBi/c0e9GIS7ByMyTQ/VhHTwUIIoZ99KiOn3Ye"], ["created_at", 2017-01-23 14:42:46 UTC], ["updated_at", 2017-01-23 14:42:46 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "authors" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author_id" integer, "description" text, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mselect sqlite_version(*)[0m
  [1m[35m (6.7ms)[0m  [1m[35mCREATE  INDEX "index_books_on_author_id" ON "books" ("author_id")[0m
  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "borrows" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "borrow_date" date, "expected_return_date" date, "return_date" date, "reader_id" integer, "publication_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_publication_id" ON "borrows" ("publication_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
[0m
  [1m[35m (6.3ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_reader_id" ON "borrows" ("reader_id")[0m
  [1m[35m (5.8ms)[0m  [1m[35mCREATE TABLE "librarians" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "card_code" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (3.8ms)[0m  [1m[35mCREATE TABLE "publications" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "ISBN" varchar, "year" integer, "publisher_id" integer, "img_url" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "book_id" integer, "borrowed" boolean DEFAULT 'f')[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_publications_on_ISBN" ON "publications" ("ISBN")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_book_id" ON "publications" ("book_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_book_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_book_id' AND type='index'
[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (5.8ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_publisher_id" ON "publications" ("publisher_id")[0m
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "publishers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (3.7ms)[0m  [1m[35mCREATE TABLE "readers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "card_code" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "reader_id" integer, "librarian_id" integer)[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE  INDEX "index_users_on_librarian_id" ON "users" ("librarian_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_users_on_librarian_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_users_on_librarian_id' AND type='index'
[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE  INDEX "index_users_on_reader_id" ON "users" ("reader_id")[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT version FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES ('20170126073016')[0m
  [1m[35m (3.6ms)[0m  [1m[32mINSERT INTO schema_migrations (version) VALUES
('20170123131023'),
('20161223112524'),
('20170107164735'),
('20170107165431'),
('20170123082356'),
('20161223112601'),
('20170107165622'),
('20170126072908'),
('20170123131531'),
('20170107170244'),
('20170107164915'),
('20170124113328');

[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", 2017-01-27 12:35:52 UTC], ["updated_at", 2017-01-27 12:35:52 UTC]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.682020', '2017-01-27 12:35:52.682020', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.682020', '2017-01-27 12:35:52.682020', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.690669', '2017-01-27 12:35:52.690669', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.690669', '2017-01-27 12:35:52.690669', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:35:52.694200', '2017-01-27 12:35:52.694200', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:35:52.694200', '2017-01-27 12:35:52.694200', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:35:52.697643', '2017-01-27 12:35:52.697643', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:35:52.697643', '2017-01-27 12:35:52.697643', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.699611', '2017-01-27 12:35:52.699611', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.699611', '2017-01-27 12:35:52.699611', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:35:52.701396', '2017-01-27 12:35:52.701396', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:35:52.701396', '2017-01-27 12:35:52.701396', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:35:52.704245', '2017-01-27 12:35:52.704245', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:35:52.704245', '2017-01-27 12:35:52.704245', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.706468', '2017-01-27 12:35:52.706468', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:35:52.706468', '2017-01-27 12:35:52.706468', 298486374)[0m
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$eOgyDvdb7K/4P73JwL6CsO4OFKrYM61bV2/0X.GEl6fmqDOENo0XC"], ["created_at", 2017-01-27 12:35:52 UTC], ["updated_at", 2017-01-27 12:35:52 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$pd9KKq7TfBLffSeTbaFemerze2kMZQMw5t7qgT/aFMS4khXCzyMFC"], ["created_at", 2017-01-27 12:35:52 UTC], ["updated_at", 2017-01-27 12:35:52 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (2.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.156623', '2017-01-27 12:46:30.156623', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.156623', '2017-01-27 12:46:30.156623', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.163465', '2017-01-27 12:46:30.163465', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.163465', '2017-01-27 12:46:30.163465', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:46:30.166534', '2017-01-27 12:46:30.166534', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:46:30.166534', '2017-01-27 12:46:30.166534', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:46:30.170071', '2017-01-27 12:46:30.170071', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:46:30.170071', '2017-01-27 12:46:30.170071', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.172564', '2017-01-27 12:46:30.172564', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.172564', '2017-01-27 12:46:30.172564', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:46:30.175072', '2017-01-27 12:46:30.175072', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:46:30.175072', '2017-01-27 12:46:30.175072', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:46:30.177184', '2017-01-27 12:46:30.177184', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:46:30.177184', '2017-01-27 12:46:30.177184', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.179397', '2017-01-27 12:46:30.179397', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:46:30.179397', '2017-01-27 12:46:30.179397', 298486374)[0m
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$VxwuuQeW6CNN6YyopvMcSeu9vttSGB2IMBJ0Zh07d8mlTXOsnWmOu"], ["created_at", 2017-01-27 12:46:30 UTC], ["updated_at", 2017-01-27 12:46:30 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$XCdMpLqjFq02Z04W05Tps.lWsIwbXuLRduLtSIwfQIbciZdeDGHvq"], ["created_at", 2017-01-27 12:46:30 UTC], ["updated_at", 2017-01-27 12:46:30 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.9ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.875792', '2017-01-27 12:51:28.875792', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.875792', '2017-01-27 12:51:28.875792', 298486374)[0m
  [1m[36mFixture Delete (0.7ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.883742', '2017-01-27 12:51:28.883742', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.883742', '2017-01-27 12:51:28.883742', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:51:28.890894', '2017-01-27 12:51:28.890894', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:51:28.890894', '2017-01-27 12:51:28.890894', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:51:28.895183', '2017-01-27 12:51:28.895183', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:51:28.895183', '2017-01-27 12:51:28.895183', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.898595', '2017-01-27 12:51:28.898595', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.898595', '2017-01-27 12:51:28.898595', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:51:28.900417', '2017-01-27 12:51:28.900417', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:51:28.900417', '2017-01-27 12:51:28.900417', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:51:28.902506', '2017-01-27 12:51:28.902506', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:51:28.902506', '2017-01-27 12:51:28.902506', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.905469', '2017-01-27 12:51:28.905469', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:51:28.905469', '2017-01-27 12:51:28.905469', 298486374)[0m
  [1m[35m (8.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.6ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (3.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$TlS1HPEBVi2BJlBTQWiiw.BtoUY/L00KNnC2D2EBt6DydWOuqqUqu"], ["created_at", 2017-01-27 12:51:29 UTC], ["updated_at", 2017-01-27 12:51:29 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$J8RpHUlHnc1SSZ7ImvAN3.ZGp1GXALXQtZzsm7g/2RtwAKIxKETGa"], ["created_at", 2017-01-27 12:51:29 UTC], ["updated_at", 2017-01-27 12:51:29 UTC]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.586380', '2017-01-27 12:54:04.586380', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.586380', '2017-01-27 12:54:04.586380', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.592978', '2017-01-27 12:54:04.592978', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.592978', '2017-01-27 12:54:04.592978', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:54:04.595551', '2017-01-27 12:54:04.595551', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:54:04.595551', '2017-01-27 12:54:04.595551', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:54:04.598419', '2017-01-27 12:54:04.598419', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:54:04.598419', '2017-01-27 12:54:04.598419', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.600429', '2017-01-27 12:54:04.600429', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.600429', '2017-01-27 12:54:04.600429', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:54:04.602152', '2017-01-27 12:54:04.602152', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:54:04.602152', '2017-01-27 12:54:04.602152', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:54:04.604208', '2017-01-27 12:54:04.604208', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:54:04.604208', '2017-01-27 12:54:04.604208', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.606662', '2017-01-27 12:54:04.606662', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:04.606662', '2017-01-27 12:54:04.606662', 298486374)[0m
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.9ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (3.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$OJakllKFA4jlESitIa3GWO.DRbnx4lSMxfl0Sk7GaZT31sauVDxaW"], ["created_at", 2017-01-27 12:54:04 UTC], ["updated_at", 2017-01-27 12:54:04 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$abcPe3eKeqAmtTFw9DIux.KFUDAunJ5vcm92uz.e4GyD3O9xe4.u."], ["created_at", 2017-01-27 12:54:04 UTC], ["updated_at", 2017-01-27 12:54:04 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.769984', '2017-01-27 12:54:33.769984', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.769984', '2017-01-27 12:54:33.769984', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.777087', '2017-01-27 12:54:33.777087', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.777087', '2017-01-27 12:54:33.777087', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (1.0ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:54:33.780415', '2017-01-27 12:54:33.780415', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:54:33.780415', '2017-01-27 12:54:33.780415', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:54:33.787810', '2017-01-27 12:54:33.787810', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:54:33.787810', '2017-01-27 12:54:33.787810', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.792778', '2017-01-27 12:54:33.792778', 980190962)[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.792778', '2017-01-27 12:54:33.792778', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:54:33.796330', '2017-01-27 12:54:33.796330', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:54:33.796330', '2017-01-27 12:54:33.796330', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:54:33.799867', '2017-01-27 12:54:33.799867', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:54:33.799867', '2017-01-27 12:54:33.799867', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.802640', '2017-01-27 12:54:33.802640', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:54:33.802640', '2017-01-27 12:54:33.802640', 298486374)[0m
  [1m[35m (4.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.9ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$zoLUhyJ9EMxR/jo1qXLG6.tkL2Karqco/vAx5HTAS6gzhsO6UOW.W"], ["created_at", 2017-01-27 12:54:33 UTC], ["updated_at", 2017-01-27 12:54:33 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$0wjukJdg7kEuYyXOZsvyCugv1MYxX3GPYozJZgY.oTqXro22kEfJm"], ["created_at", 2017-01-27 12:54:34 UTC], ["updated_at", 2017-01-27 12:54:34 UTC]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.6ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.062552', '2017-01-27 12:55:38.062552', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.062552', '2017-01-27 12:55:38.062552', 298486374)[0m
  [1m[36mFixture Delete (0.0ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.069942', '2017-01-27 12:55:38.069942', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.069942', '2017-01-27 12:55:38.069942', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("id", "ISBN", "year", "img_url", "created_at", "updated_at", "publisher_id") VALUES (1, 'MyString', 1, 'MyString', '2017-01-27 12:55:38.072460', '2017-01-27 12:55:38.072460', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:55:38.072460', '2017-01-27 12:55:38.072460', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:55:38.078035', '2017-01-27 12:55:38.078035', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:55:38.078035', '2017-01-27 12:55:38.078035', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.080973', '2017-01-27 12:55:38.080973', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.080973', '2017-01-27 12:55:38.080973', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:55:38.083832', '2017-01-27 12:55:38.083832', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:55:38.083832', '2017-01-27 12:55:38.083832', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:55:38.086720', '2017-01-27 12:55:38.086720', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:55:38.086720', '2017-01-27 12:55:38.086720', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.090806', '2017-01-27 12:55:38.090806', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:55:38.090806', '2017-01-27 12:55:38.090806', 298486374)[0m
  [1m[35m (7.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 1 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 1 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$dkNvoYht3XIJhOcjkDM5TuQz5BEfw1U8fWI8tu/wbOpVvV63NoC1q"], ["created_at", 2017-01-27 12:55:38 UTC], ["updated_at", 2017-01-27 12:55:38 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$ypocvw5VtmKhxghF6X5iTuTkRMsBqS9NdmnpxVd1haZpp347HnWjy"], ["created_at", 2017-01-27 12:55:38 UTC], ["updated_at", 2017-01-27 12:55:38 UTC]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.011179', '2017-01-27 12:57:05.011179', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.011179', '2017-01-27 12:57:05.011179', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.018497', '2017-01-27 12:57:05.018497', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.018497', '2017-01-27 12:57:05.018497', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:57:05.020908', '2017-01-27 12:57:05.020908', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:57:05.020908', '2017-01-27 12:57:05.020908', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:57:05.023882', '2017-01-27 12:57:05.023882', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:57:05.023882', '2017-01-27 12:57:05.023882', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.026306', '2017-01-27 12:57:05.026306', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.026306', '2017-01-27 12:57:05.026306', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:57:05.028438', '2017-01-27 12:57:05.028438', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:57:05.028438', '2017-01-27 12:57:05.028438', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:57:05.030636', '2017-01-27 12:57:05.030636', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:57:05.030636', '2017-01-27 12:57:05.030636', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.032957', '2017-01-27 12:57:05.032957', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:57:05.032957', '2017-01-27 12:57:05.032957', 298486374)[0m
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$g0.D2oFO7dfvKyQMgSCH1.LH9mW15bJ3wAtq1rwwy58hS.2uQgqmq"], ["created_at", 2017-01-27 12:57:05 UTC], ["updated_at", 2017-01-27 12:57:05 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$wnSk0P0NM/1d/IibP3Qe8ejV6AR8qnuaC7IhanaUY3gBZnmob4deW"], ["created_at", 2017-01-27 12:57:05 UTC], ["updated_at", 2017-01-27 12:57:05 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.5ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.7ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.249842', '2017-01-27 12:58:34.249842', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.249842', '2017-01-27 12:58:34.249842', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.256661', '2017-01-27 12:58:34.256661', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.256661', '2017-01-27 12:58:34.256661', 298486374)[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 12:58:34.260119', '2017-01-27 12:58:34.260119', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 12:58:34.260119', '2017-01-27 12:58:34.260119', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:58:34.263959', '2017-01-27 12:58:34.263959', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 12:58:34.263959', '2017-01-27 12:58:34.263959', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.266263', '2017-01-27 12:58:34.266263', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.266263', '2017-01-27 12:58:34.266263', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:58:34.268379', '2017-01-27 12:58:34.268379', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 12:58:34.268379', '2017-01-27 12:58:34.268379', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:58:34.271593', '2017-01-27 12:58:34.271593', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 12:58:34.271593', '2017-01-27 12:58:34.271593', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.274835', '2017-01-27 12:58:34.274835', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 12:58:34.274835', '2017-01-27 12:58:34.274835', 298486374)[0m
  [1m[35m (3.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$QjhhxKBDsqqOhc8mMuERRuxbClBCNJvgzSq4THvRP49T5WKZRBP02"], ["created_at", 2017-01-27 12:58:34 UTC], ["updated_at", 2017-01-27 12:58:34 UTC]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$jhxDgD9Ia1gbbYtQNWrAteo/p7wyy0F07GHlkXXhjcdw.cF9sqzO6"], ["created_at", 2017-01-27 12:58:34 UTC], ["updated_at", 2017-01-27 12:58:34 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.492348', '2017-01-27 13:04:48.492348', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.492348', '2017-01-27 13:04:48.492348', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.498872', '2017-01-27 13:04:48.498872', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.498872', '2017-01-27 13:04:48.498872', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:04:48.501744', '2017-01-27 13:04:48.501744', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:04:48.501744', '2017-01-27 13:04:48.501744', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:04:48.505418', '2017-01-27 13:04:48.505418', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:04:48.505418', '2017-01-27 13:04:48.505418', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.507668', '2017-01-27 13:04:48.507668', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.507668', '2017-01-27 13:04:48.507668', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:04:48.509384', '2017-01-27 13:04:48.509384', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:04:48.509384', '2017-01-27 13:04:48.509384', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:04:48.511576', '2017-01-27 13:04:48.511576', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:04:48.511576', '2017-01-27 13:04:48.511576', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.514189', '2017-01-27 13:04:48.514189', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:04:48.514189', '2017-01-27 13:04:48.514189', 298486374)[0m
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
AuthorsControllerTest: test_should_get_new
------------------------------------------
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:04:48 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:04:48 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 3044ms (Views: 3043.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:04:51 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:04:52 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.3ms)
Completed 200 OK in 7ms (Views: 6.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:04:52 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 7ms (ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:04:52 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:04:52 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:04:52 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (18.4ms)
Completed 200 OK in 33ms (Views: 24.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (1.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.977325', '2017-01-27 13:12:36.977325', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.977325', '2017-01-27 13:12:36.977325', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.985589', '2017-01-27 13:12:36.985589', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.985589', '2017-01-27 13:12:36.985589', 298486374)[0m
  [1m[36mFixture Delete (1.6ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:12:36.989121', '2017-01-27 13:12:36.989121', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:12:36.989121', '2017-01-27 13:12:36.989121', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:12:36.995237', '2017-01-27 13:12:36.995237', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:12:36.995237', '2017-01-27 13:12:36.995237', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.998445', '2017-01-27 13:12:36.998445', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:36.998445', '2017-01-27 13:12:36.998445', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:12:37.000577', '2017-01-27 13:12:37.000577', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:12:37.000577', '2017-01-27 13:12:37.000577', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:12:37.003112', '2017-01-27 13:12:37.003112', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:12:37.003112', '2017-01-27 13:12:37.003112', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:37.005492', '2017-01-27 13:12:37.005492', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:12:37.005492', '2017-01-27 13:12:37.005492', 298486374)[0m
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
AuthorsControllerTest: test_should_get_new
------------------------------------------
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (6.6ms)
Completed 200 OK in 164ms (Views: 163.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 37ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (17.6ms)
Completed 200 OK in 36ms (Views: 25.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:12:37 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:12:38 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 4ms (Views: 3.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:12:38 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.415321', '2017-01-27 13:13:49.415321', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.415321', '2017-01-27 13:13:49.415321', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.420678', '2017-01-27 13:13:49.420678', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.420678', '2017-01-27 13:13:49.420678', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:13:49.423787', '2017-01-27 13:13:49.423787', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:13:49.423787', '2017-01-27 13:13:49.423787', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:13:49.426771', '2017-01-27 13:13:49.426771', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:13:49.426771', '2017-01-27 13:13:49.426771', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.429093', '2017-01-27 13:13:49.429093', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.429093', '2017-01-27 13:13:49.429093', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:13:49.430863', '2017-01-27 13:13:49.430863', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:13:49.430863', '2017-01-27 13:13:49.430863', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:13:49.432900', '2017-01-27 13:13:49.432900', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:13:49.432900', '2017-01-27 13:13:49.432900', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.435111', '2017-01-27 13:13:49.435111', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:13:49.435111', '2017-01-27 13:13:49.435111', 298486374)[0m
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:13:49 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 154ms (Views: 146.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 5ms (ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 13ms (Views: 11.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (28.5ms)
Completed 200 OK in 61ms (Views: 34.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
AuthorsControllerTest: test_should_get_new
------------------------------------------
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:13:50 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.6ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.448434', '2017-01-27 13:18:04.448434', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.448434', '2017-01-27 13:18:04.448434', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.455220', '2017-01-27 13:18:04.455220', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.455220', '2017-01-27 13:18:04.455220', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:18:04.457828', '2017-01-27 13:18:04.457828', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:18:04.457828', '2017-01-27 13:18:04.457828', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:18:04.462441', '2017-01-27 13:18:04.462441', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:18:04.462441', '2017-01-27 13:18:04.462441', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.465378', '2017-01-27 13:18:04.465378', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.465378', '2017-01-27 13:18:04.465378', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:18:04.467318', '2017-01-27 13:18:04.467318', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:18:04.467318', '2017-01-27 13:18:04.467318', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:18:04.469963', '2017-01-27 13:18:04.469963', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:18:04.469963', '2017-01-27 13:18:04.469963', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.473266', '2017-01-27 13:18:04.473266', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:04.473266', '2017-01-27 13:18:04.473266', 298486374)[0m
  [1m[35m (3.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (8.3ms)
Completed 200 OK in 211ms (Views: 203.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 4ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:18:05 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (22.1ms)
Completed 200 OK in 35ms (Views: 26.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:18:06 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 6ms (Views: 4.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.300653', '2017-01-27 13:18:49.300653', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.300653', '2017-01-27 13:18:49.300653', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.307101', '2017-01-27 13:18:49.307101', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.307101', '2017-01-27 13:18:49.307101', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:18:49.309097', '2017-01-27 13:18:49.309097', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:18:49.309097', '2017-01-27 13:18:49.309097', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:18:49.312367', '2017-01-27 13:18:49.312367', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:18:49.312367', '2017-01-27 13:18:49.312367', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.315659', '2017-01-27 13:18:49.315659', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.315659', '2017-01-27 13:18:49.315659', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:18:49.317767', '2017-01-27 13:18:49.317767', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:18:49.317767', '2017-01-27 13:18:49.317767', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:18:49.319808', '2017-01-27 13:18:49.319808', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:18:49.319808', '2017-01-27 13:18:49.319808', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.322020', '2017-01-27 13:18:49.322020', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:18:49.322020', '2017-01-27 13:18:49.322020', 298486374)[0m
  [1m[35m (70.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:18:49 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 7ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:18:49 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (28.3ms)
Completed 200 OK in 182ms (Views: 176.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:18:49 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:18:50 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:18:50 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:18:50 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:18:50 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 15ms (Views: 13.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:18:50 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 7ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.365642', '2017-01-27 13:20:03.365642', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.365642', '2017-01-27 13:20:03.365642', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.371110', '2017-01-27 13:20:03.371110', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.371110', '2017-01-27 13:20:03.371110', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:20:03.374909', '2017-01-27 13:20:03.374909', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:20:03.374909', '2017-01-27 13:20:03.374909', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:20:03.378552', '2017-01-27 13:20:03.378552', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:20:03.378552', '2017-01-27 13:20:03.378552', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.381359', '2017-01-27 13:20:03.381359', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.381359', '2017-01-27 13:20:03.381359', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:20:03.383590', '2017-01-27 13:20:03.383590', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:20:03.383590', '2017-01-27 13:20:03.383590', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:20:03.386034', '2017-01-27 13:20:03.386034', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:20:03.386034', '2017-01-27 13:20:03.386034', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.389373', '2017-01-27 13:20:03.389373', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:03.389373', '2017-01-27 13:20:03.389373', 298486374)[0m
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:20:03 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 10ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:20:03 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 5ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:20:03 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.3ms)
Completed 200 OK in 170ms (Views: 169.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 3.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (26.0ms)
Completed 200 OK in 47ms (Views: 35.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by AuthorsController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Completed 404 Not Found in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:20:04 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.781454', '2017-01-27 13:20:36.781454', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.781454', '2017-01-27 13:20:36.781454', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.787887', '2017-01-27 13:20:36.787887', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.787887', '2017-01-27 13:20:36.787887', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:20:36.790584', '2017-01-27 13:20:36.790584', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:20:36.790584', '2017-01-27 13:20:36.790584', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:20:36.793258', '2017-01-27 13:20:36.793258', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:20:36.793258', '2017-01-27 13:20:36.793258', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.795242', '2017-01-27 13:20:36.795242', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.795242', '2017-01-27 13:20:36.795242', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:20:36.797342', '2017-01-27 13:20:36.797342', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:20:36.797342', '2017-01-27 13:20:36.797342', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:20:36.799485', '2017-01-27 13:20:36.799485', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:20:36.799485', '2017-01-27 13:20:36.799485', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.801610', '2017-01-27 13:20:36.801610', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:20:36.801610', '2017-01-27 13:20:36.801610', 298486374)[0m
  [1m[35m (3.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.3ms)
Completed 200 OK in 161ms (Views: 159.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 11ms (Views: 9.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 9ms (ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:20:37 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (23.7ms)
Completed 200 OK in 47ms (Views: 33.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:20:38 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.318264', '2017-01-27 13:23:16.318264', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.318264', '2017-01-27 13:23:16.318264', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.325427', '2017-01-27 13:23:16.325427', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.325427', '2017-01-27 13:23:16.325427', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:23:16.327931', '2017-01-27 13:23:16.327931', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:23:16.327931', '2017-01-27 13:23:16.327931', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:23:16.330535', '2017-01-27 13:23:16.330535', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:23:16.330535', '2017-01-27 13:23:16.330535', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.334124', '2017-01-27 13:23:16.334124', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.334124', '2017-01-27 13:23:16.334124', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:23:16.336771', '2017-01-27 13:23:16.336771', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:23:16.336771', '2017-01-27 13:23:16.336771', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:23:16.339024', '2017-01-27 13:23:16.339024', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:23:16.339024', '2017-01-27 13:23:16.339024', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.341439', '2017-01-27 13:23:16.341439', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:23:16.341439', '2017-01-27 13:23:16.341439', 298486374)[0m
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (5.7ms)
Completed 200 OK in 207ms (Views: 199.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.2ms)
Completed 200 OK in 7ms (Views: 5.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (52.7ms)
Completed 200 OK in 71ms (Views: 60.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 6ms (Views: 5.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:23:17 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 6ms (ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.008261', '2017-01-27 13:24:21.008261', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.008261', '2017-01-27 13:24:21.008261', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.014466', '2017-01-27 13:24:21.014466', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.014466', '2017-01-27 13:24:21.014466', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:24:21.018273', '2017-01-27 13:24:21.018273', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:24:21.018273', '2017-01-27 13:24:21.018273', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:24:21.021400', '2017-01-27 13:24:21.021400', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:24:21.021400', '2017-01-27 13:24:21.021400', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.023571', '2017-01-27 13:24:21.023571', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.023571', '2017-01-27 13:24:21.023571', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:24:21.025528', '2017-01-27 13:24:21.025528', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:24:21.025528', '2017-01-27 13:24:21.025528', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:24:21.027724', '2017-01-27 13:24:21.027724', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:24:21.027724', '2017-01-27 13:24:21.027724', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.029850', '2017-01-27 13:24:21.029850', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:24:21.029850', '2017-01-27 13:24:21.029850', 298486374)[0m
  [1m[35m (4.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.6ms)
Completed 200 OK in 162ms (Views: 161.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (27.4ms)
Completed 200 OK in 40ms (Views: 33.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:24:21 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:24:22 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:24:22 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 10ms (Views: 9.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:24:22 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 6ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:24:22 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.637970', '2017-01-27 13:26:24.637970', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.637970', '2017-01-27 13:26:24.637970', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.645958', '2017-01-27 13:26:24.645958', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.645958', '2017-01-27 13:26:24.645958', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:26:24.648559', '2017-01-27 13:26:24.648559', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:26:24.648559', '2017-01-27 13:26:24.648559', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:26:24.651853', '2017-01-27 13:26:24.651853', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:26:24.651853', '2017-01-27 13:26:24.651853', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.654495', '2017-01-27 13:26:24.654495', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.654495', '2017-01-27 13:26:24.654495', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:26:24.656472', '2017-01-27 13:26:24.656472', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:26:24.656472', '2017-01-27 13:26:24.656472', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:26:24.659361', '2017-01-27 13:26:24.659361', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:26:24.659361', '2017-01-27 13:26:24.659361', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.662624', '2017-01-27 13:26:24.662624', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:24.662624', '2017-01-27 13:26:24.662624', 298486374)[0m
  [1m[35m (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 16ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.7ms)
Completed 200 OK in 165ms (Views: 164.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id/destroy" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 13ms (Views: 12.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.7ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (22.2ms)
Completed 200 OK in 40ms (Views: 29.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:26:25 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.712734', '2017-01-27 13:26:52.712734', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.712734', '2017-01-27 13:26:52.712734', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.719236', '2017-01-27 13:26:52.719236', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.719236', '2017-01-27 13:26:52.719236', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:26:52.721871', '2017-01-27 13:26:52.721871', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:26:52.721871', '2017-01-27 13:26:52.721871', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:26:52.725205', '2017-01-27 13:26:52.725205', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:26:52.725205', '2017-01-27 13:26:52.725205', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.727850', '2017-01-27 13:26:52.727850', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.727850', '2017-01-27 13:26:52.727850', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:26:52.729725', '2017-01-27 13:26:52.729725', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:26:52.729725', '2017-01-27 13:26:52.729725', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:26:52.733032', '2017-01-27 13:26:52.733032', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:26:52.733032', '2017-01-27 13:26:52.733032', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.736632', '2017-01-27 13:26:52.736632', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:26:52.736632', '2017-01-27 13:26:52.736632', 298486374)[0m
  [1m[35m (4.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (5.6ms)
Completed 200 OK in 154ms (Views: 147.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 4ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (39.2ms)
Completed 200 OK in 56ms (Views: 45.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 6ms (Views: 4.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:26:53 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:26:54 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 11ms (Views: 10.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:26:54 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:26:54 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:26:54 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.7ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.903652', '2017-01-27 13:27:13.903652', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.903652', '2017-01-27 13:27:13.903652', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.909575', '2017-01-27 13:27:13.909575', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.909575', '2017-01-27 13:27:13.909575', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:27:13.911992', '2017-01-27 13:27:13.911992', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:27:13.911992', '2017-01-27 13:27:13.911992', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:27:13.914844', '2017-01-27 13:27:13.914844', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:27:13.914844', '2017-01-27 13:27:13.914844', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.916890', '2017-01-27 13:27:13.916890', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.916890', '2017-01-27 13:27:13.916890', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:27:13.918664', '2017-01-27 13:27:13.918664', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:27:13.918664', '2017-01-27 13:27:13.918664', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:27:13.920823', '2017-01-27 13:27:13.920823', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:27:13.920823', '2017-01-27 13:27:13.920823', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.923346', '2017-01-27 13:27:13.923346', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:27:13.923346', '2017-01-27 13:27:13.923346', 298486374)[0m
  [1m[35m (5.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:27:14 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 155ms (Views: 146.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:27:14 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:27:14 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (34.9ms)
Completed 200 OK in 65ms (Views: 40.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:27:14 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
Started GET "/books/index" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 5ms (Views: 4.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
BooksControllerTest: test_should_get_new
----------------------------------------
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
Started GET "/books/show" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by BooksController#show as HTML
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 7ms (ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.4ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 9ms (Views: 7.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:27:15 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.350569', '2017-01-27 13:30:39.350569', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.350569', '2017-01-27 13:30:39.350569', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.357909', '2017-01-27 13:30:39.357909', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.357909', '2017-01-27 13:30:39.357909', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:30:39.360391', '2017-01-27 13:30:39.360391', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:30:39.360391', '2017-01-27 13:30:39.360391', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:30:39.363904', '2017-01-27 13:30:39.363904', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:30:39.363904', '2017-01-27 13:30:39.363904', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.366630', '2017-01-27 13:30:39.366630', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.366630', '2017-01-27 13:30:39.366630', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:30:39.368540', '2017-01-27 13:30:39.368540', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:30:39.368540', '2017-01-27 13:30:39.368540', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:30:39.372061', '2017-01-27 13:30:39.372061', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:30:39.372061', '2017-01-27 13:30:39.372061', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.375053', '2017-01-27 13:30:39.375053', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:30:39.375053', '2017-01-27 13:30:39.375053', 298486374)[0m
  [1m[35m (4.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:30:39 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (5.1ms)
Completed 200 OK in 190ms (Views: 189.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 4ms (Views: 3.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (43.3ms)
Completed 200 OK in 55ms (Views: 47.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 6ms (Views: 4.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:30:40 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.312401', '2017-01-27 13:32:03.312401', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.312401', '2017-01-27 13:32:03.312401', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.319326', '2017-01-27 13:32:03.319326', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.319326', '2017-01-27 13:32:03.319326', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:32:03.323032', '2017-01-27 13:32:03.323032', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:32:03.323032', '2017-01-27 13:32:03.323032', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:32:03.327046', '2017-01-27 13:32:03.327046', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:32:03.327046', '2017-01-27 13:32:03.327046', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.329918', '2017-01-27 13:32:03.329918', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.329918', '2017-01-27 13:32:03.329918', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:32:03.332123', '2017-01-27 13:32:03.332123', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:32:03.332123', '2017-01-27 13:32:03.332123', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:32:03.334359', '2017-01-27 13:32:03.334359', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:32:03.334359', '2017-01-27 13:32:03.334359', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.337682', '2017-01-27 13:32:03.337682', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:32:03.337682', '2017-01-27 13:32:03.337682', 298486374)[0m
  [1m[35m (70.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:32:03 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 157ms (Views: 149.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (27.5ms)
Completed 200 OK in 44ms (Views: 37.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 10ms (Views: 8.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 12ms (Views: 9.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.7ms)
Completed 200 OK in 9ms (Views: 7.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:32:04 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
PublicationsControllerTest: test_should_get_new
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.016594', '2017-01-27 13:35:23.016594', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.016594', '2017-01-27 13:35:23.016594', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.022347', '2017-01-27 13:35:23.022347', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.022347', '2017-01-27 13:35:23.022347', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:35:23.024326', '2017-01-27 13:35:23.024326', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:35:23.024326', '2017-01-27 13:35:23.024326', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:35:23.027871', '2017-01-27 13:35:23.027871', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:35:23.027871', '2017-01-27 13:35:23.027871', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.030771', '2017-01-27 13:35:23.030771', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.030771', '2017-01-27 13:35:23.030771', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:35:23.032757', '2017-01-27 13:35:23.032757', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:35:23.032757', '2017-01-27 13:35:23.032757', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:35:23.034857', '2017-01-27 13:35:23.034857', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:35:23.034857', '2017-01-27 13:35:23.034857', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.036926', '2017-01-27 13:35:23.036926', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:35:23.036926', '2017-01-27 13:35:23.036926', 298486374)[0m
  [1m[35m (8.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------
PublicationsControllerTest: test_should_get_index
-------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
PublicationsControllerTest: test_should_get_show
------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:35:23 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (24.4ms)
Completed 200 OK in 225ms (Views: 217.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (1.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.3ms)
Completed 200 OK in 12ms (Views: 10.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mBook Load (0.0ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by AuthorsController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 14ms (Views: 12.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.3ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:35:24 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 8ms (Views: 6.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.504539', '2017-01-27 13:36:09.504539', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.504539', '2017-01-27 13:36:09.504539', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.511773', '2017-01-27 13:36:09.511773', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.511773', '2017-01-27 13:36:09.511773', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:36:09.515624', '2017-01-27 13:36:09.515624', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:36:09.515624', '2017-01-27 13:36:09.515624', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:36:09.518580', '2017-01-27 13:36:09.518580', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:36:09.518580', '2017-01-27 13:36:09.518580', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.520953', '2017-01-27 13:36:09.520953', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.520953', '2017-01-27 13:36:09.520953', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:36:09.522788', '2017-01-27 13:36:09.522788', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:36:09.522788', '2017-01-27 13:36:09.522788', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:36:09.524858', '2017-01-27 13:36:09.524858', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:36:09.524858', '2017-01-27 13:36:09.524858', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.527166', '2017-01-27 13:36:09.527166', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:09.527166', '2017-01-27 13:36:09.527166', 298486374)[0m
  [1m[35m (7.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:36:09 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 156ms (Views: 149.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (28.7ms)
Completed 200 OK in 42ms (Views: 34.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 22ms (Views: 19.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 23ms (Views: 19.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 6ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 10ms (Views: 9.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 6.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------
PublicationsControllerTest: test_should_get_index
-------------------------------------------------
  [1m[36mPublication Load (0.9ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.4ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
PublicationsControllerTest: test_should_get_show
------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:10 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.787766', '2017-01-27 13:36:30.787766', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.787766', '2017-01-27 13:36:30.787766', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.796448', '2017-01-27 13:36:30.796448', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.796448', '2017-01-27 13:36:30.796448', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:36:30.798547', '2017-01-27 13:36:30.798547', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:36:30.798547', '2017-01-27 13:36:30.798547', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:36:30.803052', '2017-01-27 13:36:30.803052', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:36:30.803052', '2017-01-27 13:36:30.803052', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.805735', '2017-01-27 13:36:30.805735', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.805735', '2017-01-27 13:36:30.805735', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:36:30.807521', '2017-01-27 13:36:30.807521', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:36:30.807521', '2017-01-27 13:36:30.807521', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:36:30.809464', '2017-01-27 13:36:30.809464', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:36:30.809464', '2017-01-27 13:36:30.809464', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.811809', '2017-01-27 13:36:30.811809', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:36:30.811809', '2017-01-27 13:36:30.811809', 298486374)[0m
  [1m[35m (8.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 10ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 156ms (Views: 154.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 4.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 7ms (Views: 6.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 5.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.8ms)
Completed 200 OK in 17ms (Views: 15.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:31 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 14ms (Views: 13.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
PublicationsControllerTest: test_should_get_show
------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/?id=980190962" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:36:32 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (24.4ms)
Completed 200 OK in 47ms (Views: 33.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.791422', '2017-01-27 13:37:49.791422', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.791422', '2017-01-27 13:37:49.791422', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.797824', '2017-01-27 13:37:49.797824', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.797824', '2017-01-27 13:37:49.797824', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:37:49.801793', '2017-01-27 13:37:49.801793', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:37:49.801793', '2017-01-27 13:37:49.801793', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:37:49.805112', '2017-01-27 13:37:49.805112', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:37:49.805112', '2017-01-27 13:37:49.805112', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.808006', '2017-01-27 13:37:49.808006', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.808006', '2017-01-27 13:37:49.808006', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:37:49.810625', '2017-01-27 13:37:49.810625', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:37:49.810625', '2017-01-27 13:37:49.810625', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:37:49.812907', '2017-01-27 13:37:49.812907', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:37:49.812907', '2017-01-27 13:37:49.812907', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.816343', '2017-01-27 13:37:49.816343', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:37:49.816343', '2017-01-27 13:37:49.816343', 298486374)[0m
  [1m[35m (5.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
PublicationsControllerTest: test_should_get_show
------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 11ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (3.4ms)
Completed 200 OK in 153ms (Views: 152.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.8ms)
Completed 200 OK in 6ms (Views: 4.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 4.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.2ms)
Completed 200 OK in 7ms (Views: 5.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (20.7ms)
Completed 200 OK in 56ms (Views: 29.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:37:50 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:37:51 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 5ms (Views: 4.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:37:51 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 10ms (Views: 8.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.275033', '2017-01-27 13:38:07.275033', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.275033', '2017-01-27 13:38:07.275033', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.280770', '2017-01-27 13:38:07.280770', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.280770', '2017-01-27 13:38:07.280770', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:38:07.283064', '2017-01-27 13:38:07.283064', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:38:07.283064', '2017-01-27 13:38:07.283064', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:38:07.285471', '2017-01-27 13:38:07.285471', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:38:07.285471', '2017-01-27 13:38:07.285471', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.287479', '2017-01-27 13:38:07.287479', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.287479', '2017-01-27 13:38:07.287479', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:38:07.289164', '2017-01-27 13:38:07.289164', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:38:07.289164', '2017-01-27 13:38:07.289164', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:38:07.291264', '2017-01-27 13:38:07.291264', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:38:07.291264', '2017-01-27 13:38:07.291264', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.293517', '2017-01-27 13:38:07.293517', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:07.293517', '2017-01-27 13:38:07.293517', 298486374)[0m
  [1m[35m (70.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 162ms (Views: 161.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.8ms)
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:38:07 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 3.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------
PublicationsControllerTest: test_should_get_show
------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 10ms (Views: 9.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (15.4ms)
Completed 200 OK in 33ms (Views: 23.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BooksController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 13ms (Views: 11.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (4.1ms)
Completed 200 OK in 13ms (Views: 11.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:08 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.944266', '2017-01-27 13:38:47.944266', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.944266', '2017-01-27 13:38:47.944266', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.950415', '2017-01-27 13:38:47.950415', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.950415', '2017-01-27 13:38:47.950415', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:38:47.952939', '2017-01-27 13:38:47.952939', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:38:47.952939', '2017-01-27 13:38:47.952939', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:38:47.956454', '2017-01-27 13:38:47.956454', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:38:47.956454', '2017-01-27 13:38:47.956454', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.959076', '2017-01-27 13:38:47.959076', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.959076', '2017-01-27 13:38:47.959076', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:38:47.962141', '2017-01-27 13:38:47.962141', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:38:47.962141', '2017-01-27 13:38:47.962141', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:38:47.964474', '2017-01-27 13:38:47.964474', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:38:47.964474', '2017-01-27 13:38:47.964474', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.966779', '2017-01-27 13:38:47.966779', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:38:47.966779', '2017-01-27 13:38:47.966779', 298486374)[0m
  [1m[35m (68.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 11ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 186ms (Views: 185.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.3ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-27 14:38:48 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (14.1ms)
Completed 200 OK in 44ms (Views: 25.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.5ms)
Completed 200 OK in 8ms (Views: 6.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 5ms (Views: 4.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.9ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:38:49 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.080978', '2017-01-27 13:41:27.080978', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.080978', '2017-01-27 13:41:27.080978', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.088317', '2017-01-27 13:41:27.088317', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.088317', '2017-01-27 13:41:27.088317', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-27 13:41:27.090334', '2017-01-27 13:41:27.090334', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-27 13:41:27.090334', '2017-01-27 13:41:27.090334', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:41:27.092619', '2017-01-27 13:41:27.092619', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-27 13:41:27.092619', '2017-01-27 13:41:27.092619', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.0ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.094616', '2017-01-27 13:41:27.094616', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.094616', '2017-01-27 13:41:27.094616', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:41:27.096403', '2017-01-27 13:41:27.096403', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-27 13:41:27.096403', '2017-01-27 13:41:27.096403', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:41:27.099237', '2017-01-27 13:41:27.099237', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-27 13:41:27.099237', '2017-01-27 13:41:27.099237', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.101749', '2017-01-27 13:41:27.101749', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-27 13:41:27.101749', '2017-01-27 13:41:27.101749', 298486374)[0m
  [1m[35m (4.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id?id=980190962" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 11ms (ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 175ms (Views: 174.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.2ms)
Completed 200 OK in 6ms (Views: 5.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.5ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 13ms (Views: 10.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.1ms)
Completed 200 OK in 13ms (Views: 10.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (16.9ms)
Completed 200 OK in 34ms (Views: 24.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-27 14:41:27 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-27 14:41:28 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 5ms (Views: 4.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.7ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.049127', '2017-01-28 09:40:24.049127', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.049127', '2017-01-28 09:40:24.049127', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.054583', '2017-01-28 09:40:24.054583', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.054583', '2017-01-28 09:40:24.054583', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:40:24.056505', '2017-01-28 09:40:24.056505', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:40:24.056505', '2017-01-28 09:40:24.056505', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:40:24.058843', '2017-01-28 09:40:24.058843', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:40:24.058843', '2017-01-28 09:40:24.058843', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.060816', '2017-01-28 09:40:24.060816', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.060816', '2017-01-28 09:40:24.060816', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:40:24.063090', '2017-01-28 09:40:24.063090', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:40:24.063090', '2017-01-28 09:40:24.063090', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:40:24.065595', '2017-01-28 09:40:24.065595', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:40:24.065595', '2017-01-28 09:40:24.065595', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.067862', '2017-01-28 09:40:24.067862', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:40:24.067862', '2017-01-28 09:40:24.067862', 298486374)[0m
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-28 10:40:24 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 10ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:40:24 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 297ms (Views: 296.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 7ms (Views: 5.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id?id=980190962" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.8ms)
Completed 200 OK in 8ms (Views: 5.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (20.0ms)
Completed 200 OK in 47ms (Views: 35.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.2ms)
Completed 200 OK in 5ms (Views: 3.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:40:25 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.7ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.709787', '2017-01-28 09:41:26.709787', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.709787', '2017-01-28 09:41:26.709787', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.714700', '2017-01-28 09:41:26.714700', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.714700', '2017-01-28 09:41:26.714700', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:41:26.716669', '2017-01-28 09:41:26.716669', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:41:26.716669', '2017-01-28 09:41:26.716669', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:41:26.719334', '2017-01-28 09:41:26.719334', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:41:26.719334', '2017-01-28 09:41:26.719334', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.721449', '2017-01-28 09:41:26.721449', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.721449', '2017-01-28 09:41:26.721449', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:41:26.723349', '2017-01-28 09:41:26.723349', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:41:26.723349', '2017-01-28 09:41:26.723349', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:41:26.725783', '2017-01-28 09:41:26.725783', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:41:26.725783', '2017-01-28 09:41:26.725783', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.0ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.727996', '2017-01-28 09:41:26.727996', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:41:26.727996', '2017-01-28 09:41:26.727996', 298486374)[0m
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 12ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (3.7ms)
Completed 200 OK in 195ms (Views: 191.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.8ms)
Completed 200 OK in 6ms (Views: 5.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.8ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 7ms (Views: 6.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:41:27 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 6ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.5ms)
Completed 200 OK in 11ms (Views: 10.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id?id=980190962" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>":id"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 0], ["LIMIT", 1]]
Redirected to http://www.example.com/books/index
Completed 302 Found in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-28 10:41:28 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (17.4ms)
Completed 200 OK in 30ms (Views: 22.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.001943', '2017-01-28 09:42:09.001943', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.001943', '2017-01-28 09:42:09.001943', 298486374)[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.008694', '2017-01-28 09:42:09.008694', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.008694', '2017-01-28 09:42:09.008694', 298486374)[0m
  [1m[36mFixture Delete (0.6ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:42:09.012384', '2017-01-28 09:42:09.012384', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:42:09.012384', '2017-01-28 09:42:09.012384', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:42:09.028071', '2017-01-28 09:42:09.028071', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:42:09.028071', '2017-01-28 09:42:09.028071', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.033492', '2017-01-28 09:42:09.033492', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.033492', '2017-01-28 09:42:09.033492', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:42:09.036975', '2017-01-28 09:42:09.036975', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:42:09.036975', '2017-01-28 09:42:09.036975', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:42:09.040667', '2017-01-28 09:42:09.040667', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:42:09.040667', '2017-01-28 09:42:09.040667', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.043037', '2017-01-28 09:42:09.043037', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:09.043037', '2017-01-28 09:42:09.043037', 298486374)[0m
  [1m[35m (73.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:42:09 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (1.5ms)
Completed 200 OK in 186ms (Views: 178.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:42:09 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 6ms (Views: 5.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.5ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 11ms (Views: 9.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.3ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (16.8ms)
Completed 200 OK in 34ms (Views: 24.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (2.2ms)
Completed 200 OK in 8ms (Views: 6.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:10 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.3ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.405307', '2017-01-28 09:42:45.405307', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.405307', '2017-01-28 09:42:45.405307', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.411548', '2017-01-28 09:42:45.411548', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.411548', '2017-01-28 09:42:45.411548', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:42:45.415342', '2017-01-28 09:42:45.415342', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:42:45.415342', '2017-01-28 09:42:45.415342', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:42:45.418666', '2017-01-28 09:42:45.418666', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:42:45.418666', '2017-01-28 09:42:45.418666', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.420745', '2017-01-28 09:42:45.420745', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.420745', '2017-01-28 09:42:45.420745', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:42:45.422495', '2017-01-28 09:42:45.422495', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:42:45.422495', '2017-01-28 09:42:45.422495', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:42:45.424464', '2017-01-28 09:42:45.424464', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:42:45.424464', '2017-01-28 09:42:45.424464', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.429030', '2017-01-28 09:42:45.429030', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:42:45.429030', '2017-01-28 09:42:45.429030', 298486374)[0m
  [1m[35m (8.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UsersControllerTest: test_should_get_create
-------------------------------------------
Started GET "/users/create" for 127.0.0.1 at 2017-01-28 10:42:45 +0100
Processing by UsersController#create as HTML
Completed 400 Bad Request in 8ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------
UsersControllerTest: test_should_get_new
----------------------------------------
Started GET "/users/new" for 127.0.0.1 at 2017-01-28 10:42:45 +0100
Processing by UsersController#new as HTML
  Rendering users/new.html.erb within layouts/application
  Rendered users/new.html.erb within layouts/application (33.8ms)
Completed 200 OK in 212ms (Views: 206.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BorrowsControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
BorrowsControllerTest: test_should_get_index
--------------------------------------------
Started GET "/borrows/index" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BorrowsController#index as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
BorrowsControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.5ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 12ms (Views: 9.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.6ms)
Completed 200 OK in 11ms (Views: 9.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
ReadersControllerTest: test_should_get_new
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
ReadersControllerTest: test_should_get_show
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.6ms)
Completed 200 OK in 18ms (Views: 15.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 16ms (Views: 13.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (33.5ms)
Completed 200 OK in 42ms (Views: 40.0ms | ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:42:46 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.4ms)
Completed 200 OK in 8ms (Views: 6.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.621130', '2017-01-28 09:43:46.621130', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.621130', '2017-01-28 09:43:46.621130', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.627356', '2017-01-28 09:43:46.627356', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.627356', '2017-01-28 09:43:46.627356', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:43:46.631350', '2017-01-28 09:43:46.631350', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:43:46.631350', '2017-01-28 09:43:46.631350', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:43:46.634505', '2017-01-28 09:43:46.634505', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:43:46.634505', '2017-01-28 09:43:46.634505', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.638063', '2017-01-28 09:43:46.638063', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.638063', '2017-01-28 09:43:46.638063', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:43:46.640305', '2017-01-28 09:43:46.640305', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:43:46.640305', '2017-01-28 09:43:46.640305', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:43:46.643172', '2017-01-28 09:43:46.643172', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:43:46.643172', '2017-01-28 09:43:46.643172', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.645909', '2017-01-28 09:43:46.645909', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:43:46.645909', '2017-01-28 09:43:46.645909', 298486374)[0m
  [1m[35m (70.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 10ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (1.4ms)
Completed 200 OK in 178ms (Views: 177.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 7ms (Views: 5.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (18.7ms)
Completed 200 OK in 25ms (Views: 23.6ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.7ms)
Completed 200 OK in 9ms (Views: 7.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.2ms)
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.7ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:43:47 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (7.6ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.708890', '2017-01-28 09:44:26.708890', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.708890', '2017-01-28 09:44:26.708890', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.720796', '2017-01-28 09:44:26.720796', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.720796', '2017-01-28 09:44:26.720796', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 09:44:26.722927', '2017-01-28 09:44:26.722927', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 09:44:26.722927', '2017-01-28 09:44:26.722927', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:44:26.725533', '2017-01-28 09:44:26.725533', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 09:44:26.725533', '2017-01-28 09:44:26.725533', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.727879', '2017-01-28 09:44:26.727879', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.727879', '2017-01-28 09:44:26.727879', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:44:26.729678', '2017-01-28 09:44:26.729678', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 09:44:26.729678', '2017-01-28 09:44:26.729678', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:44:26.731736', '2017-01-28 09:44:26.731736', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 09:44:26.731736', '2017-01-28 09:44:26.731736', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.733978', '2017-01-28 09:44:26.733978', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 09:44:26.733978', '2017-01-28 09:44:26.733978', 298486374)[0m
  [1m[35m (7.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 186ms (Views: 176.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$ubkprRQjB.W79majPcIvTOJfxx8Pjazvmg8MOcp3UsQoW0D0qI4cq"], ["created_at", 2017-01-28 09:44:27 UTC], ["updated_at", 2017-01-28 09:44:27 UTC]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$.BPtgcYCEb3FI1XhTbWQdOKOJwh/nSZega3qkK2cLwjQEdbfv4h9."], ["created_at", 2017-01-28 09:44:27 UTC], ["updated_at", 2017-01-28 09:44:27 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (0.3ms)
Completed 200 OK in 5ms (Views: 4.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.6ms)
Completed 200 OK in 12ms (Views: 10.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.9ms)
Completed 200 OK in 7ms (Views: 5.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.4ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.0ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.0ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (3.5ms)
Completed 200 OK in 12ms (Views: 11.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (17.2ms)
Completed 200 OK in 30ms (Views: 26.4ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-28 10:44:27 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", :environment]]
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE "authors" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (5.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "author_id" integer, "description" text, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mselect sqlite_version(*)[0m
  [1m[35m (7.3ms)[0m  [1m[35mCREATE  INDEX "index_books_on_author_id" ON "books" ("author_id")[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE "borrows" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "borrow_date" date, "expected_return_date" date, "return_date" date, "reader_id" integer, "publication_id" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_publication_id" ON "borrows" ("publication_id")[0m
  [1m[35m (0.2ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_borrows_on_publication_id' AND type='index'
[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE  INDEX "index_borrows_on_reader_id" ON "borrows" ("reader_id")[0m
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "librarians" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "card_code" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE "publications" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "ISBN" varchar, "year" integer, "publisher_id" integer, "img_url" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "book_id" integer, "borrowed" boolean DEFAULT 'f')[0m
  [1m[35m (6.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_publications_on_ISBN" ON "publications" ("ISBN")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (6.2ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_book_id" ON "publications" ("book_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_book_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_book_id' AND type='index'
[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_publications_on_ISBN' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_publications_on_ISBN' AND type='index'
[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE  INDEX "index_publications_on_publisher_id" ON "publications" ("publisher_id")[0m
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "publishers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (12.3ms)[0m  [1m[35mCREATE TABLE "readers" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "card_code" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "email" varchar, "password_digest" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "reader_id" integer, "librarian_id" integer, "birthday" date, "city" varchar, "street" varchar, "postcode" varchar)[0m
  [1m[35m (6.3ms)[0m  [1m[35mCREATE  INDEX "index_users_on_librarian_id" ON "users" ("librarian_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_users_on_librarian_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_users_on_librarian_id' AND type='index'
[0m
  [1m[35m (5.2ms)[0m  [1m[35mCREATE  INDEX "index_users_on_reader_id" ON "users" ("reader_id")[0m
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT version FROM "schema_migrations"[0m
  [1m[35m (5.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES ('20170128144158')[0m
  [1m[35m (4.6ms)[0m  [1m[32mINSERT INTO schema_migrations (version) VALUES
('20170128144050'),
('20170123131023'),
('20161223112524'),
('20170107164735'),
('20170107165431'),
('20170123082356'),
('20161223112601'),
('20170107165622'),
('20170126072908'),
('20170128144132'),
('20170123131531'),
('20170126073016'),
('20170128144122'),
('20170107170244'),
('20170107164915'),
('20170124113328');

[0m
  [1m[35m (8.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (1.7ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", 2017-01-28 17:27:56 UTC], ["updated_at", 2017-01-28 17:27:56 UTC]]
  [1m[35m (9.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", :environment], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.8ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.597444', '2017-01-28 17:27:56.597444', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.597444', '2017-01-28 17:27:56.597444', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.606382', '2017-01-28 17:27:56.606382', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.606382', '2017-01-28 17:27:56.606382', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:27:56.610602', '2017-01-28 17:27:56.610602', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:27:56.610602', '2017-01-28 17:27:56.610602', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:27:56.614003', '2017-01-28 17:27:56.614003', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:27:56.614003', '2017-01-28 17:27:56.614003', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.616938', '2017-01-28 17:27:56.616938', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.616938', '2017-01-28 17:27:56.616938', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:27:56.619704', '2017-01-28 17:27:56.619704', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:27:56.619704', '2017-01-28 17:27:56.619704', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:27:56.623745', '2017-01-28 17:27:56.623745', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:27:56.623745', '2017-01-28 17:27:56.623745', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.626641', '2017-01-28 17:27:56.626641', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:27:56.626641', '2017-01-28 17:27:56.626641', 298486374)[0m
  [1m[35m (5.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.4ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (1.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:27:56 UTC], ["updated_at", 2017-01-28 17:27:56 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.0ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.6ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.594175', '2017-01-28 17:29:44.594175', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.594175', '2017-01-28 17:29:44.594175', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.603239', '2017-01-28 17:29:44.603239', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.603239', '2017-01-28 17:29:44.603239', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:29:44.606603', '2017-01-28 17:29:44.606603', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:29:44.606603', '2017-01-28 17:29:44.606603', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:29:44.610018', '2017-01-28 17:29:44.610018', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:29:44.610018', '2017-01-28 17:29:44.610018', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.613428', '2017-01-28 17:29:44.613428', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.613428', '2017-01-28 17:29:44.613428', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:29:44.615877', '2017-01-28 17:29:44.615877', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:29:44.615877', '2017-01-28 17:29:44.615877', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:29:44.618883', '2017-01-28 17:29:44.618883', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:29:44.618883', '2017-01-28 17:29:44.618883', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.621870', '2017-01-28 17:29:44.621870', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:29:44.621870', '2017-01-28 17:29:44.621870', 298486374)[0m
  [1m[35m (69.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$Fm.gGQniQvKlxC3vntLqiuOCBkIVz.J0uFT4XqkQ7YYfILQZ24ab6"], ["created_at", 2017-01-28 17:29:44 UTC], ["updated_at", 2017-01-28 17:29:44 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$24zb/aYsDE3Sfj2xsmwJwuPy0eSya7ySwCoqYaOZvqIz1XFbNFiIW"], ["created_at", 2017-01-28 17:29:44 UTC], ["updated_at", 2017-01-28 17:29:44 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (1.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (12.7ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (1.0ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:29:44 UTC], ["updated_at", 2017-01-28 17:29:44 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:52.997995', '2017-01-28 17:30:52.997995', 980190962)[0m
  [1m[36mFixture Insert (0.7ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:52.997995', '2017-01-28 17:30:52.997995', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.006767', '2017-01-28 17:30:53.006767', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.006767', '2017-01-28 17:30:53.006767', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:30:53.009644', '2017-01-28 17:30:53.009644', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:30:53.009644', '2017-01-28 17:30:53.009644', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:30:53.013033', '2017-01-28 17:30:53.013033', 980190962, 980190962)[0m
  [1m[36mFixture Insert (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:30:53.013033', '2017-01-28 17:30:53.013033', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.017572', '2017-01-28 17:30:53.017572', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.017572', '2017-01-28 17:30:53.017572', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:30:53.020451', '2017-01-28 17:30:53.020451', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:30:53.020451', '2017-01-28 17:30:53.020451', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:30:53.024086', '2017-01-28 17:30:53.024086', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:30:53.024086', '2017-01-28 17:30:53.024086', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.027064', '2017-01-28 17:30:53.027064', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:30:53.027064', '2017-01-28 17:30:53.027064', 298486374)[0m
  [1m[35m (4.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (2.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$7r0rjEmcrQykDkknTsFzFupuZKbc8v.mXafbTgYWC99ZbiiLlrnHS"], ["created_at", 2017-01-28 17:30:53 UTC], ["updated_at", 2017-01-28 17:30:53 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$GMgo1jx2R2Y5Ohduta5pHe4bT24NUHj2lkNI6oet8ygrcEe.ZLlT2"], ["created_at", 2017-01-28 17:30:53 UTC], ["updated_at", 2017-01-28 17:30:53 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:30:53 UTC], ["updated_at", 2017-01-28 17:30:53 UTC]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.303431', '2017-01-28 17:33:34.303431', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.303431', '2017-01-28 17:33:34.303431', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.311314', '2017-01-28 17:33:34.311314', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.311314', '2017-01-28 17:33:34.311314', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:33:34.314965', '2017-01-28 17:33:34.314965', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:33:34.314965', '2017-01-28 17:33:34.314965', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:33:34.320870', '2017-01-28 17:33:34.320870', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:33:34.320870', '2017-01-28 17:33:34.320870', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.325329', '2017-01-28 17:33:34.325329', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.325329', '2017-01-28 17:33:34.325329', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:33:34.329129', '2017-01-28 17:33:34.329129', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:33:34.329129', '2017-01-28 17:33:34.329129', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:33:34.333661', '2017-01-28 17:33:34.333661', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:33:34.333661', '2017-01-28 17:33:34.333661', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.337080', '2017-01-28 17:33:34.337080', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:33:34.337080', '2017-01-28 17:33:34.337080', 298486374)[0m
  [1m[35m (68.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (2.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$Ktn.OUVRFJpcCtfLfOFfTuuf.gQPLR2GMTvY713pkl2bLBGCceLlC"], ["created_at", 2017-01-28 17:33:34 UTC], ["updated_at", 2017-01-28 17:33:34 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (2.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$bDuI/W9yEAFcAGTO9BTjTuDvHTiTttZfUYqZjYhl3ubzTzP8RzBCO"], ["created_at", 2017-01-28 17:33:34 UTC], ["updated_at", 2017-01-28 17:33:34 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:33:34 UTC], ["updated_at", 2017-01-28 17:33:34 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[35m (2.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.364168', '2017-01-28 17:34:56.364168', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.364168', '2017-01-28 17:34:56.364168', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.372092', '2017-01-28 17:34:56.372092', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.372092', '2017-01-28 17:34:56.372092', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:34:56.374914', '2017-01-28 17:34:56.374914', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:34:56.374914', '2017-01-28 17:34:56.374914', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:34:56.378829', '2017-01-28 17:34:56.378829', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:34:56.378829', '2017-01-28 17:34:56.378829', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.383051', '2017-01-28 17:34:56.383051', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.383051', '2017-01-28 17:34:56.383051', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:34:56.385508', '2017-01-28 17:34:56.385508', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:34:56.385508', '2017-01-28 17:34:56.385508', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:34:56.388782', '2017-01-28 17:34:56.388782', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:34:56.388782', '2017-01-28 17:34:56.388782', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.392174', '2017-01-28 17:34:56.392174', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:34:56.392174', '2017-01-28 17:34:56.392174', 298486374)[0m
  [1m[35m (5.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:34:56 UTC], ["updated_at", 2017-01-28 17:34:56 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.0ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$fLonBo0okB8h7HLvrA.cpur7k.aoV6x8NZIhtnjwyM6zkuMb0UP8."], ["created_at", 2017-01-28 17:34:56 UTC], ["updated_at", 2017-01-28 17:34:56 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$seA4VCI4OnUS4J7JitiRJ.DmHIyeWBPskO8t.aR12EYIX3T6PCm2."], ["created_at", 2017-01-28 17:34:56 UTC], ["updated_at", 2017-01-28 17:34:56 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.654564', '2017-01-28 17:35:13.654564', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.654564', '2017-01-28 17:35:13.654564', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.661127', '2017-01-28 17:35:13.661127', 980190962)[0m
  [1m[36mFixture Insert (0.0ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.661127', '2017-01-28 17:35:13.661127', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:35:13.663767', '2017-01-28 17:35:13.663767', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:35:13.663767', '2017-01-28 17:35:13.663767', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:35:13.668278', '2017-01-28 17:35:13.668278', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:35:13.668278', '2017-01-28 17:35:13.668278', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.672721', '2017-01-28 17:35:13.672721', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.672721', '2017-01-28 17:35:13.672721', 298486374)[0m
  [1m[36mFixture Delete (0.0ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:35:13.677043', '2017-01-28 17:35:13.677043', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:35:13.677043', '2017-01-28 17:35:13.677043', 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:35:13.681666', '2017-01-28 17:35:13.681666', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:35:13.681666', '2017-01-28 17:35:13.681666', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.685955', '2017-01-28 17:35:13.685955', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:13.685955', '2017-01-28 17:35:13.685955', 298486374)[0m
  [1m[35m (8.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$2MZwW1NxOlMuJ6gzFpKEreYFaEG8RHIsLRa4z46tYMujPGiEesibu"], ["created_at", 2017-01-28 17:35:13 UTC], ["updated_at", 2017-01-28 17:35:13 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$EZzspcZGQNPX2NvV/kjf.uv08ibX.2s6kOQ3.qS1ZeebAhujIxurK"], ["created_at", 2017-01-28 17:35:13 UTC], ["updated_at", 2017-01-28 17:35:13 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.6ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:35:14 UTC], ["updated_at", 2017-01-28 17:35:14 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.4ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.929826', '2017-01-28 17:35:54.929826', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.929826', '2017-01-28 17:35:54.929826', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.940745', '2017-01-28 17:35:54.940745', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.940745', '2017-01-28 17:35:54.940745', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-28 17:35:54.943560', '2017-01-28 17:35:54.943560', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-28 17:35:54.943560', '2017-01-28 17:35:54.943560', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:35:54.947226', '2017-01-28 17:35:54.947226', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-28 17:35:54.947226', '2017-01-28 17:35:54.947226', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.955565', '2017-01-28 17:35:54.955565', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.955565', '2017-01-28 17:35:54.955565', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:35:54.958297', '2017-01-28 17:35:54.958297', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-28 17:35:54.958297', '2017-01-28 17:35:54.958297', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:35:54.961705', '2017-01-28 17:35:54.961705', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-28 17:35:54.961705', '2017-01-28 17:35:54.961705', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.964879', '2017-01-28 17:35:54.964879', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-28 17:35:54.964879', '2017-01-28 17:35:54.964879', 298486374)[0m
  [1m[35m (5.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$8X45F9CvYR4dEu5hrhGGXOXu/hrAOMh7ZCer5OOAljcAoSxKC.grq"], ["created_at", 2017-01-28 17:35:55 UTC], ["updated_at", 2017-01-28 17:35:55 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$sOJ86bltI47noPjT6E6iPeAq81/BvX3.1.XM/SEprE82QYy1V5j66"], ["created_at", 2017-01-28 17:35:55 UTC], ["updated_at", 2017-01-28 17:35:55 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (1.5ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sat, 28 Jan 2017], ["expected_return_date", Sun, 29 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-28 17:35:55 UTC], ["updated_at", 2017-01-28 17:35:55 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (2.4ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.687966', '2017-01-29 07:59:01.687966', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.687966', '2017-01-29 07:59:01.687966', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.705691', '2017-01-29 07:59:01.705691', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.705691', '2017-01-29 07:59:01.705691', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-29 07:59:01.708225', '2017-01-29 07:59:01.708225', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-29 07:59:01.708225', '2017-01-29 07:59:01.708225', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 07:59:01.711339', '2017-01-29 07:59:01.711339', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 07:59:01.711339', '2017-01-29 07:59:01.711339', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.713992', '2017-01-29 07:59:01.713992', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.713992', '2017-01-29 07:59:01.713992', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 07:59:01.716477', '2017-01-29 07:59:01.716477', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 07:59:01.716477', '2017-01-29 07:59:01.716477', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 07:59:01.719389', '2017-01-29 07:59:01.719389', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 07:59:01.719389', '2017-01-29 07:59:01.719389', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.723038', '2017-01-29 07:59:01.723038', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 07:59:01.723038', '2017-01-29 07:59:01.723038', 298486374)[0m
  [1m[35m (8.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
PublicationTest: test_ISBN_should_be_present
--------------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
PublicationTest: test_should_be_valid
-------------------------------------
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? LIMIT ?[0m  [["ISBN", "123abc"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
BorrowTest: test_should_be_valid
--------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------
BorrowTest: test_should_be_active
---------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
BorrowTest: test_cannot_borrow_publication_that_is_already_borrowed
-------------------------------------------------------------------
  [1m[36mPublication Load (0.8ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublication Load (1.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35mSQL (3.8ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "reader_id", "publication_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["borrow_date", Sun, 29 Jan 2017], ["expected_return_date", Mon, 30 Jan 2017], ["reader_id", 980190962], ["publication_id", 980190962], ["created_at", 2017-01-29 07:59:01 UTC], ["updated_at", 2017-01-29 07:59:01 UTC]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 298486374], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------
BorrowTest: test_publication_should_be_present
----------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.3ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.4ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" IS NULL LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
BorrowTest: test_should_not_be_active
-------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.1ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BorrowTest: test_reader_should_be_present
-----------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.0ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (2.9ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mReader Load (0.2ms)[0m  [1m[34mSELECT  "readers".* FROM "readers" WHERE "readers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrows" WHERE (publication_id = 980190962 and return_date IS NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 08:59:02 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 35ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-29 08:59:02 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (20.1ms)
Completed 200 OK in 3989ms (Views: 3983.9ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (0.8ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
BookTest: test_should_be_valid
------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
BookTest: test_title_should_be_present
--------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
BookTest: test_author_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
ReaderTest: test_should_be_valid
--------------------------------
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ReaderTest: test_card_code_should_be_present
--------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
PublisherTest: test_name_should_be_present
------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
PublisherTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.3ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.9ms)
Completed 200 OK in 11ms (Views: 9.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.4ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (11.9ms)
Completed 200 OK in 24ms (Views: 20.3ms | ActiveRecord: 0.8ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
LibrarianTest: test_card_code_should_be_present
-----------------------------------------------
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------
LibrarianTest: test_should_be_valid
-----------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.5ms)
Completed 200 OK in 12ms (Views: 8.7ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------
AuthorTest: test_name_should_be_present
---------------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------
AuthorTest: test_should_be_valid
--------------------------------
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-29 08:59:06 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (1.2ms)
Completed 200 OK in 16ms (Views: 12.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------
UserTest: test_email_addresses_should_be_unique
-----------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "test@example.com"], ["password_digest", "$2a$04$mYIdabmE0bJ5cImlt9AwaeUsi6WssnSJJxn2g90Lkl06iGfg/QzRa"], ["created_at", 2017-01-29 07:59:06 UTC], ["updated_at", 2017-01-29 07:59:06 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "TEST@EXAMPLE.COM"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------
UserTest: test_email_should_be_present
--------------------------------------
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "     "], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------
UserTest: test_validation_should_accept_valid_addresses
-------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "USER@example.COM"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u-s-e-r@ex.am.ple"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "u.S.e-r@example.cz"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
UserTest: test_name_should_not_be_too_long
------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_email_addresses_should_be_saved_lower-case
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "UseR@ExAMPle.CoM"], ["LIMIT", 1]]
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "birthday", "city", "street", "postcode") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["name", "Test user"], ["email", "user@example.com"], ["password_digest", "$2a$04$LoyiqIvKeFYdv5qPHkPnqutRX4kZ0wHOreWfiBOUiPIZhfPdbniKO"], ["created_at", 2017-01-29 07:59:06 UTC], ["updated_at", 2017-01-29 07:59:06 UTC], ["birthday", Thu, 02 Feb 2017], ["city", "some city"], ["street", "some street 1230"], ["postcode", "789456123"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 980190963], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_email_should_not_be_too_long
-------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------
UserTest: test_name_should_be_present
-------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "     "], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
UserTest: test_password_should_not_be_blank
-------------------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------
UserTest: test_validation_should_reject_invalid_addresses
---------------------------------------------------------
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example,com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "useratexample.org"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user.test@example."], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "user@example_example.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------
UserTest: test_should_be_valid
------------------------------
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."name") = LOWER(?) LIMIT ?[0m  [["name", "Test user"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER(?) LIMIT ?[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.2ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.104730', '2017-01-29 08:07:26.104730', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.104730', '2017-01-29 08:07:26.104730', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.111178', '2017-01-29 08:07:26.111178', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.111178', '2017-01-29 08:07:26.111178', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-29 08:07:26.115853', '2017-01-29 08:07:26.115853', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-29 08:07:26.115853', '2017-01-29 08:07:26.115853', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:07:26.119061', '2017-01-29 08:07:26.119061', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:07:26.119061', '2017-01-29 08:07:26.119061', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.121594', '2017-01-29 08:07:26.121594', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.121594', '2017-01-29 08:07:26.121594', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:07:26.123980', '2017-01-29 08:07:26.123980', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:07:26.123980', '2017-01-29 08:07:26.123980', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:07:26.127813', '2017-01-29 08:07:26.127813', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:07:26.127813', '2017-01-29 08:07:26.127813', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.130625', '2017-01-29 08:07:26.130625', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:07:26.130625', '2017-01-29 08:07:26.130625', 298486374)[0m
  [1m[35m (7.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (4.3ms)
Completed 200 OK in 203ms (Views: 194.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
LibrariansControllerTest: test_should_not_get_new_when_not_authorized
---------------------------------------------------------------------
  [1m[36mLibrarian Load (0.3ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/librarians/new?id=1" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
LibrariansControllerTest: test_should_not_show_when_not_authorized
------------------------------------------------------------------
  [1m[36mLibrarian Load (0.1ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/librarians/:id" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 8ms (Views: 7.1ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.2ms)
Completed 200 OK in 10ms (Views: 8.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.4ms)
Completed 200 OK in 10ms (Views: 8.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-29 09:07:26 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.5ms)
Completed 200 OK in 12ms (Views: 10.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-29 09:07:27 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (15.7ms)
Completed 200 OK in 24ms (Views: 21.3ms | ActiveRecord: 0.4ms)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-29 09:07:27 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-29 09:07:27 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:07:27 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-29 09:07:27 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.788740', '2017-01-29 08:08:20.788740', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.788740', '2017-01-29 08:08:20.788740', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.794612', '2017-01-29 08:08:20.794612', 980190962)[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.794612', '2017-01-29 08:08:20.794612', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-29 08:08:20.797325', '2017-01-29 08:08:20.797325', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-29 08:08:20.797325', '2017-01-29 08:08:20.797325', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:08:20.800526', '2017-01-29 08:08:20.800526', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:08:20.800526', '2017-01-29 08:08:20.800526', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.804058', '2017-01-29 08:08:20.804058', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.804058', '2017-01-29 08:08:20.804058', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:08:20.806648', '2017-01-29 08:08:20.806648', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:08:20.806648', '2017-01-29 08:08:20.806648', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:08:20.809826', '2017-01-29 08:08:20.809826', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:08:20.809826', '2017-01-29 08:08:20.809826', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.812969', '2017-01-29 08:08:20.812969', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:20.812969', '2017-01-29 08:08:20.812969', 298486374)[0m
  [1m[35m (4.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
LibrariansControllerTest: test_should_not_get_new_when_not_authorized
---------------------------------------------------------------------
  [1m[36mLibrarian Load (0.2ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/librarians/new?id=1" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by LibrariansController#new as HTML
  Parameters: {"id"=>"1"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 13ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
LibrariansControllerTest: test_should_not_show_when_not_authorized
------------------------------------------------------------------
  [1m[36mLibrarian Load (0.1ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/librarians/:id" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (1.8ms)
Completed 200 OK in 227ms (Views: 226.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.5ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (20.1ms)
Completed 200 OK in 31ms (Views: 26.0ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.3ms)
Completed 200 OK in 9ms (Views: 7.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (2.5ms)
Completed 200 OK in 21ms (Views: 14.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (1.4ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.1ms)
Completed 200 OK in 9ms (Views: 7.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-29 09:08:21 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (0.4ms)
Completed 200 OK in 8ms (Views: 5.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mFixture Delete (1.5ms)[0m  [1m[31mDELETE FROM "readers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.765036', '2017-01-29 08:08:36.765036', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "readers" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.765036', '2017-01-29 08:08:36.765036', 298486374)[0m
  [1m[36mFixture Delete (0.3ms)[0m  [1m[31mDELETE FROM "publishers"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.772665', '2017-01-29 08:08:36.772665', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publishers" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.772665', '2017-01-29 08:08:36.772665', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "publications"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString', 1, 'MyString', '2017-01-29 08:08:36.777905', '2017-01-29 08:08:36.777905', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "publications" ("ISBN", "year", "img_url", "created_at", "updated_at", "id", "publisher_id") VALUES ('MyString2', 1, 'MyString', '2017-01-29 08:08:36.777905', '2017-01-29 08:08:36.777905', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "books"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:08:36.782492', '2017-01-29 08:08:36.782492', 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "description", "created_at", "updated_at", "id", "author_id") VALUES ('MyString', 'MyText', '2017-01-29 08:08:36.782492', '2017-01-29 08:08:36.782492', 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "librarians"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.784994', '2017-01-29 08:08:36.784994', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "librarians" ("card_code", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.784994', '2017-01-29 08:08:36.784994', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "users"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:08:36.787449', '2017-01-29 08:08:36.787449', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "created_at", "updated_at", "id") VALUES ('MyString', 'MyString', 'MyString', '2017-01-29 08:08:36.787449', '2017-01-29 08:08:36.787449', 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "borrows"[0m
  [1m[36mFixture Insert (0.2ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:08:36.790720', '2017-01-29 08:08:36.790720', 980190962, 980190962, 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "borrows" ("borrow_date", "expected_return_date", "return_date", "created_at", "updated_at", "id", "reader_id", "publication_id") VALUES ('2017-01-23', '2017-01-23', '2017-01-23', '2017-01-29 08:08:36.790720', '2017-01-29 08:08:36.790720', 298486374, 298486374, 298486374)[0m
  [1m[36mFixture Delete (0.1ms)[0m  [1m[31mDELETE FROM "authors"[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.794121', '2017-01-29 08:08:36.794121', 980190962)[0m
  [1m[36mFixture Insert (0.1ms)[0m  [1m[32mINSERT INTO "authors" ("name", "created_at", "updated_at", "id") VALUES ('MyString', '2017-01-29 08:08:36.794121', '2017-01-29 08:08:36.794121', 298486374)[0m
  [1m[35m (6.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
AuthorsControllerTest: test_should_get_index
--------------------------------------------
  [1m[36mAuthor Load (0.3ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by AuthorsController#index as HTML
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (6.4ms)
Completed 200 OK in 217ms (Views: 206.8ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------
AuthorsControllerTest: test_should_get_show
-------------------------------------------
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by AuthorsController#index as HTML
  Parameters: {"id"=>"980190962"}
  Rendering authors/index.html.erb within layouts/application
  Rendered authors/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 8ms (Views: 6.5ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
AuthorsControllerTest: test_should_not_delete_when_not_authorized
-----------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/authors/:id" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by AuthorsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_edit_when_not_authorized
-------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by AuthorsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
AuthorsControllerTest: test_should_not_get_new_when_not_authorized
------------------------------------------------------------------
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/authors/new" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by AuthorsController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------
BooksControllerTest: test_should_get_index
------------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by BooksController#index as HTML
  Rendering books/index.html.erb within layouts/application
  Rendered books/index.html.erb within layouts/application (1.7ms)
Completed 200 OK in 12ms (Views: 9.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------
BooksControllerTest: test_should_get_show
-----------------------------------------
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by BooksController#show as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  Rendering books/show.html.erb within layouts/application
  [1m[36mAuthor Load (0.2ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Load (0.3ms)[0m  [1m[34mSELECT "publications".* FROM "publications" WHERE "publications"."book_id" = ?[0m  [["book_id", 980190962]]
  Rendered books/show.html.erb within layouts/application (16.8ms)
Completed 200 OK in 27ms (Views: 23.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------
BooksControllerTest: test_should_not_get_edit_when_not_authorized
-----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by BooksController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------
BooksControllerTest: test_should_not_delete_when_not_authorized
---------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/:id" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------
BooksControllerTest: test_should_not_get_new_when_not_authorized
----------------------------------------------------------------
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT  "books".* FROM "books" WHERE "books"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAuthor Load (0.1ms)[0m  [1m[34mSELECT  "authors".* FROM "authors" WHERE "authors"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/new" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by BooksController#new as HTML
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------
MainPageControllerTest: test_should_get_index
---------------------------------------------
Started GET "/main_page/index" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by MainPageController#index as HTML
  Rendering main_page/index.html.erb within layouts/application
  Rendered main_page/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 9ms (Views: 8.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
--------------------------------------------
ContactControllerTest: test_should_get_index
--------------------------------------------
Started GET "/contact" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by ContactController#index as HTML
  Rendering contact/index.html.erb within layouts/application
  Rendered contact/index.html.erb within layouts/application (1.3ms)
Completed 200 OK in 10ms (Views: 8.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_delete_when_not_authorized
----------------------------------------------------------------------
  [1m[36mPublication Load (0.2ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.2ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started DELETE "/publications/:id" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by PublicationsController#destroy as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
-----------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_new_when_not_authorized
-----------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/books/:id/publications/new?id=1" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by PublicationsController#new as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------------
PublicationsControllerTest: test_should_not_get_edit_when_not_authorized
------------------------------------------------------------------------
  [1m[36mPublication Load (0.1ms)[0m  [1m[34mSELECT  "publications".* FROM "publications" WHERE "publications"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPublisher Load (0.1ms)[0m  [1m[34mSELECT  "publishers".* FROM "publishers" WHERE "publishers"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mPublication Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "publications" WHERE "publications"."ISBN" = ? AND ("publications"."id" != ?) LIMIT ?[0m  [["ISBN", "MyString"], ["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Started GET "/publications/:id/edit?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by PublicationsController#edit as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
---------------------------------------------------------------------
LibrariansControllerTest: test_should_not_get_new_when_not_authorized
---------------------------------------------------------------------
  [1m[36mLibrarian Load (0.2ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/librarians/new?id=1" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by LibrariansController#new as HTML
  Parameters: {"id"=>"1"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
------------------------------------------------------------------
LibrariansControllerTest: test_should_not_show_when_not_authorized
------------------------------------------------------------------
  [1m[36mLibrarian Load (0.1ms)[0m  [1m[34mSELECT  "librarians".* FROM "librarians" WHERE "librarians"."id" = ? LIMIT ?[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/librarians/:id?id=980190962" for 127.0.0.1 at 2017-01-29 09:08:37 +0100
Processing by LibrariansController#show as HTML
  Parameters: {"id"=>":id"}
Redirected to http://www.example.com/librarians/denied
Filter chain halted as :authorize_librarians rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
